/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={46:function(e,t,o){var n;n=function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=20)}([function(e,t){var n={};e.exports=n,function(){n._baseDelta=1e3/60,n._nextId=0,n._seed=0,n._nowStartTime=+new Date,n._warnedOnce={},n._decomp=null,n.extend=function(e,t){var o,r;"boolean"==typeof t?(o=2,r=t):(o=1,r=!0);for(var i=o;i<arguments.length;i++){var a=arguments[i];if(a)for(var s in a)r&&a[s]&&a[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=a[s]:(e[s]=e[s]||{},n.extend(e[s],r,a[s])):e[s]=a[s]}return e},n.clone=function(e,t){return n.extend({},t,e)},n.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var o in e)t.push(o);return t},n.values=function(e){var t=[];if(Object.keys){for(var o=Object.keys(e),n=0;n<o.length;n++)t.push(e[o[n]]);return t}for(var r in e)t.push(e[r]);return t},n.get=function(e,t,o,n){t=t.split(".").slice(o,n);for(var r=0;r<t.length;r+=1)e=e[t[r]];return e},n.set=function(e,t,o,r,i){var a=t.split(".").slice(r,i);return n.get(e,t,0,-1)[a[a.length-1]]=o,o},n.shuffle=function(e){for(var t=e.length-1;t>0;t--){var o=Math.floor(n.random()*(t+1)),r=e[t];e[t]=e[o],e[o]=r}return e},n.choose=function(e){return e[Math.floor(n.random()*e.length)]},n.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isFunction=function(e){return"function"==typeof e},n.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},n.isString=function(e){return"[object String]"===toString.call(e)},n.clamp=function(e,t,o){return e<t?t:e>o?o:e},n.sign=function(e){return e<0?-1:1},n.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-n._nowStartTime},n.random=function(t,o){return o=void 0!==o?o:1,(t=void 0!==t?t:0)+e()*(o-t)};var e=function(){return n._seed=(9301*n._seed+49297)%233280,n._seed/233280};n.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},n.logLevel=1,n.log=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.info=function(){console&&n.logLevel>0&&n.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warn=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warnOnce=function(){var e=Array.prototype.slice.call(arguments).join(" ");n._warnedOnce[e]||(n.warn(e),n._warnedOnce[e]=!0)},n.deprecated=function(e,t,o){e[t]=n.chain((function(){n.warnOnce("🔅 deprecated 🔅",o)}),e[t])},n.nextId=function(){return n._nextId++},n.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var o=0;o<e.length;o++)if(e[o]===t)return o;return-1},n.map=function(e,t){if(e.map)return e.map(t);for(var o=[],n=0;n<e.length;n+=1)o.push(t(e[n]));return o},n.topologicalSort=function(e){var t=[],o=[],r=[];for(var i in e)o[i]||r[i]||n._topologicalSort(i,o,r,e,t);return t},n._topologicalSort=function(e,t,o,r,i){var a=r[e]||[];o[e]=!0;for(var s=0;s<a.length;s+=1){var l=a[s];o[l]||t[l]||n._topologicalSort(l,t,o,r,i)}o[e]=!1,t[e]=!0,i.push(e)},n.chain=function(){for(var e=[],t=0;t<arguments.length;t+=1){var o=arguments[t];o._chained?e.push.apply(e,o._chained):e.push(o)}var n=function(){for(var t,o=new Array(arguments.length),n=0,r=arguments.length;n<r;n++)o[n]=arguments[n];for(n=0;n<e.length;n+=1){var i=e[n].apply(t,o);void 0!==i&&(t=i)}return t};return n._chained=e,n},n.chainPathBefore=function(e,t,o){return n.set(e,t,n.chain(o,n.get(e,t)))},n.chainPathAfter=function(e,t,o){return n.set(e,t,n.chain(n.get(e,t),o))},n.setDecomp=function(e){n._decomp=e},n.getDecomp=function(){var e=n._decomp;try{e||"undefined"==typeof window||(e=window.decomp),e||void 0===o.g||(e=o.g.decomp)}catch(t){e=null}return e}}()},function(e,t){var o={};e.exports=o,o.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&o.update(t,e),t},o.update=function(e,t,o){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var n=0;n<t.length;n++){var r=t[n];r.x>e.max.x&&(e.max.x=r.x),r.x<e.min.x&&(e.min.x=r.x),r.y>e.max.y&&(e.max.y=r.y),r.y<e.min.y&&(e.min.y=r.y)}o&&(o.x>0?e.max.x+=o.x:e.min.x+=o.x,o.y>0?e.max.y+=o.y:e.min.y+=o.y)},o.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},o.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},o.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},o.shift=function(e,t){var o=e.max.x-e.min.x,n=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+o,e.min.y=t.y,e.max.y=t.y+n}},function(e,t){var o={};e.exports=o,o.create=function(e,t){return{x:e||0,y:t||0}},o.clone=function(e){return{x:e.x,y:e.y}},o.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},o.rotate=function(e,t,o){var n=Math.cos(t),r=Math.sin(t);o||(o={});var i=e.x*n-e.y*r;return o.y=e.x*r+e.y*n,o.x=i,o},o.rotateAbout=function(e,t,o,n){var r=Math.cos(t),i=Math.sin(t);n||(n={});var a=o.x+((e.x-o.x)*r-(e.y-o.y)*i);return n.y=o.y+((e.x-o.x)*i+(e.y-o.y)*r),n.x=a,n},o.normalise=function(e){var t=o.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},o.dot=function(e,t){return e.x*t.x+e.y*t.y},o.cross=function(e,t){return e.x*t.y-e.y*t.x},o.cross3=function(e,t,o){return(t.x-e.x)*(o.y-e.y)-(t.y-e.y)*(o.x-e.x)},o.add=function(e,t,o){return o||(o={}),o.x=e.x+t.x,o.y=e.y+t.y,o},o.sub=function(e,t,o){return o||(o={}),o.x=e.x-t.x,o.y=e.y-t.y,o},o.mult=function(e,t){return{x:e.x*t,y:e.y*t}},o.div=function(e,t){return{x:e.x/t,y:e.y/t}},o.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},o.neg=function(e){return{x:-e.x,y:-e.y}},o.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},o._temp=[o.create(),o.create(),o.create(),o.create(),o.create(),o.create()]},function(e,t,o){var n={};e.exports=n;var r=o(2),i=o(0);n.create=function(e,t){for(var o=[],n=0;n<e.length;n++){var r=e[n],i={x:r.x,y:r.y,index:n,body:t,isInternal:!1};o.push(i)}return o},n.fromPath=function(e,t){var o=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(e,t,n){o.push({x:parseFloat(t),y:parseFloat(n)})})),n.create(o,t)},n.centre=function(e){for(var t,o,i,a=n.area(e,!0),s={x:0,y:0},l=0;l<e.length;l++)i=(l+1)%e.length,t=r.cross(e[l],e[i]),o=r.mult(r.add(e[l],e[i]),t),s=r.add(s,o);return r.div(s,6*a)},n.mean=function(e){for(var t={x:0,y:0},o=0;o<e.length;o++)t.x+=e[o].x,t.y+=e[o].y;return r.div(t,e.length)},n.area=function(e,t){for(var o=0,n=e.length-1,r=0;r<e.length;r++)o+=(e[n].x-e[r].x)*(e[n].y+e[r].y),n=r;return t?o/2:Math.abs(o)/2},n.inertia=function(e,t){for(var o,n,i=0,a=0,s=e,l=0;l<s.length;l++)n=(l+1)%s.length,i+=(o=Math.abs(r.cross(s[n],s[l])))*(r.dot(s[n],s[n])+r.dot(s[n],s[l])+r.dot(s[l],s[l])),a+=o;return t/6*(i/a)},n.translate=function(e,t,o){o=void 0!==o?o:1;var n,r=e.length,i=t.x*o,a=t.y*o;for(n=0;n<r;n++)e[n].x+=i,e[n].y+=a;return e},n.rotate=function(e,t,o){if(0!==t){var n,r,i,a,s=Math.cos(t),l=Math.sin(t),c=o.x,d=o.y,u=e.length;for(a=0;a<u;a++)r=(n=e[a]).x-c,i=n.y-d,n.x=c+(r*s-i*l),n.y=d+(r*l+i*s);return e}},n.contains=function(e,t){for(var o,n=t.x,r=t.y,i=e.length,a=e[i-1],s=0;s<i;s++){if(o=e[s],(n-a.x)*(o.y-a.y)+(r-a.y)*(a.x-o.x)>0)return!1;a=o}return!0},n.scale=function(e,t,o,i){if(1===t&&1===o)return e;var a,s;i=i||n.centre(e);for(var l=0;l<e.length;l++)a=e[l],s=r.sub(a,i),e[l].x=i.x+s.x*t,e[l].y=i.y+s.y*o;return e},n.chamfer=function(e,t,o,n,a){t="number"==typeof t?[t]:t||[8],o=void 0!==o?o:-1,n=n||2,a=a||14;for(var s=[],l=0;l<e.length;l++){var c=e[l-1>=0?l-1:e.length-1],d=e[l],u=e[(l+1)%e.length],h=t[l<t.length?l:t.length-1];if(0!==h){var f=r.normalise({x:d.y-c.y,y:c.x-d.x}),p=r.normalise({x:u.y-d.y,y:d.x-u.x}),v=Math.sqrt(2*Math.pow(h,2)),y=r.mult(i.clone(f),h),g=r.normalise(r.mult(r.add(f,p),.5)),m=r.sub(d,r.mult(g,v)),x=o;-1===o&&(x=1.75*Math.pow(h,.32)),(x=i.clamp(x,n,a))%2==1&&(x+=1);for(var b=Math.acos(r.dot(f,p))/x,M=0;M<x;M++)s.push(r.add(r.rotate(y,b*M),m))}else s.push(d)}return s},n.clockwiseSort=function(e){var t=n.mean(e);return e.sort((function(e,o){return r.angle(t,e)-r.angle(t,o)})),e},n.isConvex=function(e){var t,o,n,r,i=0,a=e.length;if(a<3)return null;for(t=0;t<a;t++)if(n=(t+2)%a,r=(e[o=(t+1)%a].x-e[t].x)*(e[n].y-e[o].y),(r-=(e[o].y-e[t].y)*(e[n].x-e[o].x))<0?i|=1:r>0&&(i|=2),3===i)return!1;return 0!==i||null},n.hull=function(e){var t,o,n=[],i=[];for((e=e.slice(0)).sort((function(e,t){var o=e.x-t.x;return 0!==o?o:e.y-t.y})),o=0;o<e.length;o+=1){for(t=e[o];i.length>=2&&r.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(o=e.length-1;o>=0;o-=1){for(t=e[o];n.length>=2&&r.cross3(n[n.length-2],n[n.length-1],t)<=0;)n.pop();n.push(t)}return n.pop(),i.pop(),n.concat(i)}},function(e,t,o){var n={};e.exports=n;var r=o(3),i=o(2),a=o(7),s=o(0),l=o(1),c=o(11);!function(){n._timeCorrection=!0,n._inertiaScale=4,n._nextCollidingGroupId=1,n._nextNonCollidingGroupId=-1,n._nextCategory=1,n._baseDelta=1e3/60,n.create=function(t){var o={id:s.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:r.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:1e3/60,_original:null},n=s.extend(o,t);return e(n,t),n},n.nextGroup=function(e){return e?n._nextNonCollidingGroupId--:n._nextCollidingGroupId++},n.nextCategory=function(){return n._nextCategory=n._nextCategory<<1,n._nextCategory};var e=function(e,t){t=t||{},n.set(e,{bounds:e.bounds||l.create(e.vertices),positionPrev:e.positionPrev||i.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),r.rotate(e.vertices,e.angle,e.position),c.rotate(e.axes,e.angle),l.update(e.bounds,e.vertices,e.velocity),n.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var o=e.isStatic?"#14151f":s.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),a=e.isStatic?"#555":"#ccc",d=e.isStatic&&null===e.render.fillStyle?1:0;e.render.fillStyle=e.render.fillStyle||o,e.render.strokeStyle=e.render.strokeStyle||a,e.render.lineWidth=e.render.lineWidth||d,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};n.set=function(e,t,o){var r;for(r in"string"==typeof t&&(r=t,(t={})[r]=o),t)if(Object.prototype.hasOwnProperty.call(t,r))switch(o=t[r],r){case"isStatic":n.setStatic(e,o);break;case"isSleeping":a.set(e,o);break;case"mass":n.setMass(e,o);break;case"density":n.setDensity(e,o);break;case"inertia":n.setInertia(e,o);break;case"vertices":n.setVertices(e,o);break;case"position":n.setPosition(e,o);break;case"angle":n.setAngle(e,o);break;case"velocity":n.setVelocity(e,o);break;case"angularVelocity":n.setAngularVelocity(e,o);break;case"speed":n.setSpeed(e,o);break;case"angularSpeed":n.setAngularSpeed(e,o);break;case"parts":n.setParts(e,o);break;case"centre":n.setCentre(e,o);break;default:e[r]=o}},n.setStatic=function(e,t){for(var o=0;o<e.parts.length;o++){var n=e.parts[o];n.isStatic=t,t?(n._original={restitution:n.restitution,friction:n.friction,mass:n.mass,inertia:n.inertia,density:n.density,inverseMass:n.inverseMass,inverseInertia:n.inverseInertia},n.restitution=0,n.friction=1,n.mass=n.inertia=n.density=1/0,n.inverseMass=n.inverseInertia=0,n.positionPrev.x=n.position.x,n.positionPrev.y=n.position.y,n.anglePrev=n.angle,n.angularVelocity=0,n.speed=0,n.angularSpeed=0,n.motion=0):n._original&&(n.restitution=n._original.restitution,n.friction=n._original.friction,n.mass=n._original.mass,n.inertia=n._original.inertia,n.density=n._original.density,n.inverseMass=n._original.inverseMass,n.inverseInertia=n._original.inverseInertia,n._original=null)}},n.setMass=function(e,t){var o=e.inertia/(e.mass/6);e.inertia=o*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},n.setDensity=function(e,t){n.setMass(e,t*e.area),e.density=t},n.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},n.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=r.create(t,e),e.axes=c.fromVertices(e.vertices),e.area=r.area(e.vertices),n.setMass(e,e.density*e.area);var o=r.centre(e.vertices);r.translate(e.vertices,o,-1),n.setInertia(e,n._inertiaScale*r.inertia(e.vertices,e.mass)),r.translate(e.vertices,e.position),l.update(e.bounds,e.vertices,e.velocity)},n.setParts=function(e,t,o){var i;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,i=0;i<t.length;i++){var a=t[i];a!==e&&(a.parent=e,e.parts.push(a))}if(1!==e.parts.length){if(o=void 0===o||o){var s=[];for(i=0;i<t.length;i++)s=s.concat(t[i].vertices);r.clockwiseSort(s);var l=r.hull(s),c=r.centre(l);n.setVertices(e,l),r.translate(e.vertices,c)}var d=n._totalProperties(e);e.area=d.area,e.parent=e,e.position.x=d.centre.x,e.position.y=d.centre.y,e.positionPrev.x=d.centre.x,e.positionPrev.y=d.centre.y,n.setMass(e,d.mass),n.setInertia(e,d.inertia),n.setPosition(e,d.centre)}},n.setCentre=function(e,t,o){o?(e.positionPrev.x+=t.x,e.positionPrev.y+=t.y,e.position.x+=t.x,e.position.y+=t.y):(e.positionPrev.x=t.x-(e.position.x-e.positionPrev.x),e.positionPrev.y=t.y-(e.position.y-e.positionPrev.y),e.position.x=t.x,e.position.y=t.y)},n.setPosition=function(e,t,o){var n=i.sub(t,e.position);o?(e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.velocity.x=n.x,e.velocity.y=n.y,e.speed=i.magnitude(n)):(e.positionPrev.x+=n.x,e.positionPrev.y+=n.y);for(var a=0;a<e.parts.length;a++){var s=e.parts[a];s.position.x+=n.x,s.position.y+=n.y,r.translate(s.vertices,n),l.update(s.bounds,s.vertices,e.velocity)}},n.setAngle=function(e,t,o){var n=t-e.angle;o?(e.anglePrev=e.angle,e.angularVelocity=n,e.angularSpeed=Math.abs(n)):e.anglePrev+=n;for(var a=0;a<e.parts.length;a++){var s=e.parts[a];s.angle+=n,r.rotate(s.vertices,n,e.position),c.rotate(s.axes,n),l.update(s.bounds,s.vertices,e.velocity),a>0&&i.rotateAbout(s.position,n,e.position,s.position)}},n.setVelocity=function(e,t){var o=e.deltaTime/n._baseDelta;e.positionPrev.x=e.position.x-t.x*o,e.positionPrev.y=e.position.y-t.y*o,e.velocity.x=(e.position.x-e.positionPrev.x)/o,e.velocity.y=(e.position.y-e.positionPrev.y)/o,e.speed=i.magnitude(e.velocity)},n.getVelocity=function(e){var t=n._baseDelta/e.deltaTime;return{x:(e.position.x-e.positionPrev.x)*t,y:(e.position.y-e.positionPrev.y)*t}},n.getSpeed=function(e){return i.magnitude(n.getVelocity(e))},n.setSpeed=function(e,t){n.setVelocity(e,i.mult(i.normalise(n.getVelocity(e)),t))},n.setAngularVelocity=function(e,t){var o=e.deltaTime/n._baseDelta;e.anglePrev=e.angle-t*o,e.angularVelocity=(e.angle-e.anglePrev)/o,e.angularSpeed=Math.abs(e.angularVelocity)},n.getAngularVelocity=function(e){return(e.angle-e.anglePrev)*n._baseDelta/e.deltaTime},n.getAngularSpeed=function(e){return Math.abs(n.getAngularVelocity(e))},n.setAngularSpeed=function(e,t){n.setAngularVelocity(e,s.sign(n.getAngularVelocity(e))*t)},n.translate=function(e,t,o){n.setPosition(e,i.add(e.position,t),o)},n.rotate=function(e,t,o,r){if(o){var i=Math.cos(t),a=Math.sin(t),s=e.position.x-o.x,l=e.position.y-o.y;n.setPosition(e,{x:o.x+(s*i-l*a),y:o.y+(s*a+l*i)},r),n.setAngle(e,e.angle+t,r)}else n.setAngle(e,e.angle+t,r)},n.scale=function(e,t,o,i){var a=0,s=0;i=i||e.position;for(var d=0;d<e.parts.length;d++){var u=e.parts[d];r.scale(u.vertices,t,o,i),u.axes=c.fromVertices(u.vertices),u.area=r.area(u.vertices),n.setMass(u,e.density*u.area),r.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),n.setInertia(u,n._inertiaScale*r.inertia(u.vertices,u.mass)),r.translate(u.vertices,{x:u.position.x,y:u.position.y}),d>0&&(a+=u.area,s+=u.inertia),u.position.x=i.x+(u.position.x-i.x)*t,u.position.y=i.y+(u.position.y-i.y)*o,l.update(u.bounds,u.vertices,e.velocity)}e.parts.length>1&&(e.area=a,e.isStatic||(n.setMass(e,e.density*a),n.setInertia(e,s))),e.circleRadius&&(t===o?e.circleRadius*=t:e.circleRadius=null)},n.update=function(e,t){var o=(t=(void 0!==t?t:1e3/60)*e.timeScale)*t,a=n._timeCorrection?t/(e.deltaTime||t):1,d=1-e.frictionAir*(t/s._baseDelta),u=(e.position.x-e.positionPrev.x)*a,h=(e.position.y-e.positionPrev.y)*a;e.velocity.x=u*d+e.force.x/e.mass*o,e.velocity.y=h*d+e.force.y/e.mass*o,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.deltaTime=t,e.angularVelocity=(e.angle-e.anglePrev)*d*a+e.torque/e.inertia*o,e.anglePrev=e.angle,e.angle+=e.angularVelocity;for(var f=0;f<e.parts.length;f++){var p=e.parts[f];r.translate(p.vertices,e.velocity),f>0&&(p.position.x+=e.velocity.x,p.position.y+=e.velocity.y),0!==e.angularVelocity&&(r.rotate(p.vertices,e.angularVelocity,e.position),c.rotate(p.axes,e.angularVelocity),f>0&&i.rotateAbout(p.position,e.angularVelocity,e.position,p.position)),l.update(p.bounds,p.vertices,e.velocity)}},n.updateVelocities=function(e){var t=n._baseDelta/e.deltaTime,o=e.velocity;o.x=(e.position.x-e.positionPrev.x)*t,o.y=(e.position.y-e.positionPrev.y)*t,e.speed=Math.sqrt(o.x*o.x+o.y*o.y),e.angularVelocity=(e.angle-e.anglePrev)*t,e.angularSpeed=Math.abs(e.angularVelocity)},n.applyForce=function(e,t,o){var n=t.x-e.position.x,r=t.y-e.position.y;e.force.x+=o.x,e.force.y+=o.y,e.torque+=n*o.y-r*o.x},n._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},o=1===e.parts.length?0:1;o<e.parts.length;o++){var n=e.parts[o],r=n.mass!==1/0?n.mass:1;t.mass+=r,t.area+=n.area,t.inertia+=n.inertia,t.centre=i.add(t.centre,i.mult(n.position,r))}return t.centre=i.div(t.centre,t.mass),t}}()},function(e,t,o){var n={};e.exports=n;var r=o(0);n.on=function(e,t,o){for(var n,r=t.split(" "),i=0;i<r.length;i++)n=r[i],e.events=e.events||{},e.events[n]=e.events[n]||[],e.events[n].push(o);return o},n.off=function(e,t,o){if(t){"function"==typeof t&&(o=t,t=r.keys(e.events).join(" "));for(var n=t.split(" "),i=0;i<n.length;i++){var a=e.events[n[i]],s=[];if(o&&a)for(var l=0;l<a.length;l++)a[l]!==o&&s.push(a[l]);e.events[n[i]]=s}}else e.events={}},n.trigger=function(e,t,o){var n,i,a,s,l=e.events;if(l&&r.keys(l).length>0){o||(o={}),n=t.split(" ");for(var c=0;c<n.length;c++)if(a=l[i=n[c]]){(s=r.clone(o,!1)).name=i,s.source=e;for(var d=0;d<a.length;d++)a[d].apply(e,[s])}}}},function(e,t,o){var n={};e.exports=n;var r=o(5),i=o(0),a=o(1),s=o(4);n.create=function(e){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},e)},n.setModified=function(e,t,o,r){if(e.isModified=t,t&&e.cache&&(e.cache.allBodies=null,e.cache.allConstraints=null,e.cache.allComposites=null),o&&e.parent&&n.setModified(e.parent,t,o,r),r)for(var i=0;i<e.composites.length;i++){var a=e.composites[i];n.setModified(a,t,o,r)}},n.add=function(e,t){var o=[].concat(t);r.trigger(e,"beforeAdd",{object:t});for(var a=0;a<o.length;a++){var s=o[a];switch(s.type){case"body":if(s.parent!==s){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}n.addBody(e,s);break;case"constraint":n.addConstraint(e,s);break;case"composite":n.addComposite(e,s);break;case"mouseConstraint":n.addConstraint(e,s.constraint)}}return r.trigger(e,"afterAdd",{object:t}),e},n.remove=function(e,t,o){var i=[].concat(t);r.trigger(e,"beforeRemove",{object:t});for(var a=0;a<i.length;a++){var s=i[a];switch(s.type){case"body":n.removeBody(e,s,o);break;case"constraint":n.removeConstraint(e,s,o);break;case"composite":n.removeComposite(e,s,o);break;case"mouseConstraint":n.removeConstraint(e,s.constraint)}}return r.trigger(e,"afterRemove",{object:t}),e},n.addComposite=function(e,t){return e.composites.push(t),t.parent=e,n.setModified(e,!0,!0,!1),e},n.removeComposite=function(e,t,o){var r=i.indexOf(e.composites,t);if(-1!==r&&n.removeCompositeAt(e,r),o)for(var a=0;a<e.composites.length;a++)n.removeComposite(e.composites[a],t,!0);return e},n.removeCompositeAt=function(e,t){return e.composites.splice(t,1),n.setModified(e,!0,!0,!1),e},n.addBody=function(e,t){return e.bodies.push(t),n.setModified(e,!0,!0,!1),e},n.removeBody=function(e,t,o){var r=i.indexOf(e.bodies,t);if(-1!==r&&n.removeBodyAt(e,r),o)for(var a=0;a<e.composites.length;a++)n.removeBody(e.composites[a],t,!0);return e},n.removeBodyAt=function(e,t){return e.bodies.splice(t,1),n.setModified(e,!0,!0,!1),e},n.addConstraint=function(e,t){return e.constraints.push(t),n.setModified(e,!0,!0,!1),e},n.removeConstraint=function(e,t,o){var r=i.indexOf(e.constraints,t);if(-1!==r&&n.removeConstraintAt(e,r),o)for(var a=0;a<e.composites.length;a++)n.removeConstraint(e.composites[a],t,!0);return e},n.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),n.setModified(e,!0,!0,!1),e},n.clear=function(e,t,o){if(o)for(var r=0;r<e.composites.length;r++)n.clear(e.composites[r],t,!0);return t?e.bodies=e.bodies.filter((function(e){return e.isStatic})):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,n.setModified(e,!0,!0,!1),e},n.allBodies=function(e){if(e.cache&&e.cache.allBodies)return e.cache.allBodies;for(var t=[].concat(e.bodies),o=0;o<e.composites.length;o++)t=t.concat(n.allBodies(e.composites[o]));return e.cache&&(e.cache.allBodies=t),t},n.allConstraints=function(e){if(e.cache&&e.cache.allConstraints)return e.cache.allConstraints;for(var t=[].concat(e.constraints),o=0;o<e.composites.length;o++)t=t.concat(n.allConstraints(e.composites[o]));return e.cache&&(e.cache.allConstraints=t),t},n.allComposites=function(e){if(e.cache&&e.cache.allComposites)return e.cache.allComposites;for(var t=[].concat(e.composites),o=0;o<e.composites.length;o++)t=t.concat(n.allComposites(e.composites[o]));return e.cache&&(e.cache.allComposites=t),t},n.get=function(e,t,o){var r,i;switch(o){case"body":r=n.allBodies(e);break;case"constraint":r=n.allConstraints(e);break;case"composite":r=n.allComposites(e).concat(e)}return r?0===(i=r.filter((function(e){return e.id.toString()===t.toString()}))).length?null:i[0]:null},n.move=function(e,t,o){return n.remove(e,t),n.add(o,t),e},n.rebase=function(e){for(var t=n.allBodies(e).concat(n.allConstraints(e)).concat(n.allComposites(e)),o=0;o<t.length;o++)t[o].id=i.nextId();return e},n.translate=function(e,t,o){for(var r=o?n.allBodies(e):e.bodies,i=0;i<r.length;i++)s.translate(r[i],t);return e},n.rotate=function(e,t,o,r){for(var i=Math.cos(t),a=Math.sin(t),l=r?n.allBodies(e):e.bodies,c=0;c<l.length;c++){var d=l[c],u=d.position.x-o.x,h=d.position.y-o.y;s.setPosition(d,{x:o.x+(u*i-h*a),y:o.y+(u*a+h*i)}),s.rotate(d,t)}return e},n.scale=function(e,t,o,r,i){for(var a=i?n.allBodies(e):e.bodies,l=0;l<a.length;l++){var c=a[l],d=c.position.x-r.x,u=c.position.y-r.y;s.setPosition(c,{x:r.x+d*t,y:r.y+u*o}),s.scale(c,t,o)}return e},n.bounds=function(e){for(var t=n.allBodies(e),o=[],r=0;r<t.length;r+=1){var i=t[r];o.push(i.bounds.min,i.bounds.max)}return a.create(o)}},function(e,t,o){var n={};e.exports=n;var r=o(4),i=o(5),a=o(0);n._motionWakeThreshold=.18,n._motionSleepThreshold=.08,n._minBias=.9,n.update=function(e,t){for(var o=t/a._baseDelta,i=n._motionSleepThreshold,s=0;s<e.length;s++){var l=e[s],c=r.getSpeed(l),d=r.getAngularSpeed(l),u=c*c+d*d;if(0===l.force.x&&0===l.force.y){var h=Math.min(l.motion,u),f=Math.max(l.motion,u);l.motion=n._minBias*h+(1-n._minBias)*f,l.sleepThreshold>0&&l.motion<i?(l.sleepCounter+=1,l.sleepCounter>=l.sleepThreshold/o&&n.set(l,!0)):l.sleepCounter>0&&(l.sleepCounter-=1)}else n.set(l,!1)}},n.afterCollisions=function(e){for(var t=n._motionSleepThreshold,o=0;o<e.length;o++){var r=e[o];if(r.isActive){var i=r.collision,a=i.bodyA.parent,s=i.bodyB.parent;if(!(a.isSleeping&&s.isSleeping||a.isStatic||s.isStatic)&&(a.isSleeping||s.isSleeping)){var l=a.isSleeping&&!a.isStatic?a:s,c=l===a?s:a;!l.isStatic&&c.motion>t&&n.set(l,!1)}}}},n.set=function(e,t){var o=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,o||i.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,o&&i.trigger(e,"sleepEnd"))}},function(e,t,o){var n={};e.exports=n;var r,i,a,s=o(3),l=o(9);r=[],i={overlap:0,axis:null},a={overlap:0,axis:null},n.create=function(e,t){return{pair:null,collided:!1,bodyA:e,bodyB:t,parentA:e.parent,parentB:t.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},n.collides=function(e,t,o){if(n._overlapAxes(i,e.vertices,t.vertices,e.axes),i.overlap<=0)return null;if(n._overlapAxes(a,t.vertices,e.vertices,t.axes),a.overlap<=0)return null;var r,c,d=o&&o.table[l.id(e,t)];d?r=d.collision:((r=n.create(e,t)).collided=!0,r.bodyA=e.id<t.id?e:t,r.bodyB=e.id<t.id?t:e,r.parentA=r.bodyA.parent,r.parentB=r.bodyB.parent),e=r.bodyA,t=r.bodyB,c=i.overlap<a.overlap?i:a;var u=r.normal,h=r.supports,f=c.axis,p=f.x,v=f.y;p*(t.position.x-e.position.x)+v*(t.position.y-e.position.y)<0?(u.x=p,u.y=v):(u.x=-p,u.y=-v),r.tangent.x=-u.y,r.tangent.y=u.x,r.depth=c.overlap,r.penetration.x=u.x*r.depth,r.penetration.y=u.y*r.depth;var y=n._findSupports(e,t,u,1),g=0;if(s.contains(e.vertices,y[0])&&(h[g++]=y[0]),s.contains(e.vertices,y[1])&&(h[g++]=y[1]),g<2){var m=n._findSupports(t,e,u,-1);s.contains(t.vertices,m[0])&&(h[g++]=m[0]),g<2&&s.contains(t.vertices,m[1])&&(h[g++]=m[1])}return 0===g&&(h[g++]=y[0]),h.length=g,r},n._overlapAxes=function(e,t,o,n){var r,i,a,s,l,c,d=t.length,u=o.length,h=t[0].x,f=t[0].y,p=o[0].x,v=o[0].y,y=n.length,g=Number.MAX_VALUE,m=0;for(l=0;l<y;l++){var x=n[l],b=x.x,M=x.y,S=h*b+f*M,A=p*b+v*M,P=S,w=A;for(c=1;c<d;c+=1)(s=t[c].x*b+t[c].y*M)>P?P=s:s<S&&(S=s);for(c=1;c<u;c+=1)(s=o[c].x*b+o[c].y*M)>w?w=s:s<A&&(A=s);if((r=(i=P-A)<(a=w-S)?i:a)<g&&(g=r,m=l,r<=0))break}e.axis=n[m],e.overlap=g},n._projectToAxis=function(e,t,o){for(var n=t[0].x*o.x+t[0].y*o.y,r=n,i=1;i<t.length;i+=1){var a=t[i].x*o.x+t[i].y*o.y;a>r?r=a:a<n&&(n=a)}e.min=n,e.max=r},n._findSupports=function(e,t,o,n){var i,a,s,l,c,d=t.vertices,u=d.length,h=e.position.x,f=e.position.y,p=o.x*n,v=o.y*n,y=Number.MAX_VALUE;for(c=0;c<u;c+=1)(l=p*(h-(a=d[c]).x)+v*(f-a.y))<y&&(y=l,i=a);return y=p*(h-(s=d[(u+i.index-1)%u]).x)+v*(f-s.y),p*(h-(a=d[(i.index+1)%u]).x)+v*(f-a.y)<y?(r[0]=i,r[1]=a,r):(r[0]=i,r[1]=s,r)}},function(e,t,o){var n={};e.exports=n;var r=o(16);n.create=function(e,t){var o=e.bodyA,r=e.bodyB,i={id:n.id(o,r),bodyA:o,bodyB:r,collision:e,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:o.isSensor||r.isSensor,timeCreated:t,timeUpdated:t,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return n.update(i,e,t),i},n.update=function(e,t,o){var n=e.contacts,i=t.supports,a=e.activeContacts,s=t.parentA,l=t.parentB,c=s.vertices.length;e.isActive=!0,e.timeUpdated=o,e.collision=t,e.separation=t.depth,e.inverseMass=s.inverseMass+l.inverseMass,e.friction=s.friction<l.friction?s.friction:l.friction,e.frictionStatic=s.frictionStatic>l.frictionStatic?s.frictionStatic:l.frictionStatic,e.restitution=s.restitution>l.restitution?s.restitution:l.restitution,e.slop=s.slop>l.slop?s.slop:l.slop,t.pair=e,a.length=0;for(var d=0;d<i.length;d++){var u=i[d],h=u.body===s?u.index:c+u.index,f=n[h];f?a.push(f):a.push(n[h]=r.create(u))}},n.setActive=function(e,t,o){t?(e.isActive=!0,e.timeUpdated=o):(e.isActive=!1,e.activeContacts.length=0)},n.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},function(e,t,o){var n={};e.exports=n;var r=o(3),i=o(2),a=o(7),s=o(1),l=o(11),c=o(0);n._warming=.4,n._torqueDampen=1,n._minLength=1e-6,n.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var o=t.bodyA?i.add(t.bodyA.position,t.pointA):t.pointA,n=t.bodyB?i.add(t.bodyB.position,t.pointB):t.pointB,r=i.magnitude(i.sub(o,n));t.length=void 0!==t.length?t.length:r,t.id=t.id||c.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var a={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&t.stiffness>.1?(a.type="pin",a.anchors=!1):t.stiffness<.9&&(a.type="spring"),t.render=c.extend(a,t.render),t},n.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var o=e[t],n=o.constraintImpulse;o.isStatic||0===n.x&&0===n.y&&0===n.angle||(o.position.x+=n.x,o.position.y+=n.y,o.angle+=n.angle)}},n.solveAll=function(e,t){for(var o=c.clamp(t/c._baseDelta,0,1),r=0;r<e.length;r+=1){var i=e[r],a=!i.bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic;(a||s)&&n.solve(e[r],o)}for(r=0;r<e.length;r+=1)a=!(i=e[r]).bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic,a||s||n.solve(e[r],o)},n.solve=function(e,t){var o=e.bodyA,r=e.bodyB,a=e.pointA,s=e.pointB;if(o||r){o&&!o.isStatic&&(i.rotate(a,o.angle-e.angleA,a),e.angleA=o.angle),r&&!r.isStatic&&(i.rotate(s,r.angle-e.angleB,s),e.angleB=r.angle);var l=a,c=s;if(o&&(l=i.add(o.position,a)),r&&(c=i.add(r.position,s)),l&&c){var d=i.sub(l,c),u=i.magnitude(d);u<n._minLength&&(u=n._minLength);var h,f,p,v,y,g=(u-e.length)/u,m=e.stiffness>=1||0===e.length?e.stiffness*t:e.stiffness*t*t,x=e.damping*t,b=i.mult(d,g*m),M=(o?o.inverseMass:0)+(r?r.inverseMass:0),S=M+((o?o.inverseInertia:0)+(r?r.inverseInertia:0));if(x>0){var A=i.create();p=i.div(d,u),y=i.sub(r&&i.sub(r.position,r.positionPrev)||A,o&&i.sub(o.position,o.positionPrev)||A),v=i.dot(p,y)}o&&!o.isStatic&&(f=o.inverseMass/M,o.constraintImpulse.x-=b.x*f,o.constraintImpulse.y-=b.y*f,o.position.x-=b.x*f,o.position.y-=b.y*f,x>0&&(o.positionPrev.x-=x*p.x*v*f,o.positionPrev.y-=x*p.y*v*f),h=i.cross(a,b)/S*n._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle-=h,o.angle-=h),r&&!r.isStatic&&(f=r.inverseMass/M,r.constraintImpulse.x+=b.x*f,r.constraintImpulse.y+=b.y*f,r.position.x+=b.x*f,r.position.y+=b.y*f,x>0&&(r.positionPrev.x+=x*p.x*v*f,r.positionPrev.y+=x*p.y*v*f),h=i.cross(s,b)/S*n._torqueDampen*r.inverseInertia*(1-e.angularStiffness),r.constraintImpulse.angle+=h,r.angle+=h)}}},n.postSolveAll=function(e){for(var t=0;t<e.length;t++){var o=e[t],c=o.constraintImpulse;if(!(o.isStatic||0===c.x&&0===c.y&&0===c.angle)){a.set(o,!1);for(var d=0;d<o.parts.length;d++){var u=o.parts[d];r.translate(u.vertices,c),d>0&&(u.position.x+=c.x,u.position.y+=c.y),0!==c.angle&&(r.rotate(u.vertices,c.angle,o.position),l.rotate(u.axes,c.angle),d>0&&i.rotateAbout(u.position,c.angle,o.position,u.position)),s.update(u.bounds,u.vertices,o.velocity)}c.angle*=n._warming,c.x*=n._warming,c.y*=n._warming}}},n.pointAWorld=function(e){return{x:(e.bodyA?e.bodyA.position.x:0)+(e.pointA?e.pointA.x:0),y:(e.bodyA?e.bodyA.position.y:0)+(e.pointA?e.pointA.y:0)}},n.pointBWorld=function(e){return{x:(e.bodyB?e.bodyB.position.x:0)+(e.pointB?e.pointB.x:0),y:(e.bodyB?e.bodyB.position.y:0)+(e.pointB?e.pointB.y:0)}}},function(e,t,o){var n={};e.exports=n;var r=o(2),i=o(0);n.fromVertices=function(e){for(var t={},o=0;o<e.length;o++){var n=(o+1)%e.length,a=r.normalise({x:e[n].y-e[o].y,y:e[o].x-e[n].x}),s=0===a.y?1/0:a.x/a.y;t[s=s.toFixed(3).toString()]=a}return i.values(t)},n.rotate=function(e,t){if(0!==t)for(var o=Math.cos(t),n=Math.sin(t),r=0;r<e.length;r++){var i,a=e[r];i=a.x*o-a.y*n,a.y=a.x*n+a.y*o,a.x=i}}},function(e,t,o){var n={};e.exports=n;var r=o(3),i=o(0),a=o(4),s=o(1),l=o(2);n.rectangle=function(e,t,o,n,s){s=s||{};var l={label:"Rectangle Body",position:{x:e,y:t},vertices:r.fromPath("L 0 0 L "+o+" 0 L "+o+" "+n+" L 0 "+n)};if(s.chamfer){var c=s.chamfer;l.vertices=r.chamfer(l.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete s.chamfer}return a.create(i.extend({},l,s))},n.trapezoid=function(e,t,o,n,s,l){l=l||{};var c,d=o*(s*=.5),u=d+(1-2*s)*o,h=u+d;c=s<.5?"L 0 0 L "+d+" "+-n+" L "+u+" "+-n+" L "+h+" 0":"L 0 0 L "+u+" "+-n+" L "+h+" 0";var f={label:"Trapezoid Body",position:{x:e,y:t},vertices:r.fromPath(c)};if(l.chamfer){var p=l.chamfer;f.vertices=r.chamfer(f.vertices,p.radius,p.quality,p.qualityMin,p.qualityMax),delete l.chamfer}return a.create(i.extend({},f,l))},n.circle=function(e,t,o,r,a){r=r||{};var s={label:"Circle Body",circleRadius:o};a=a||25;var l=Math.ceil(Math.max(10,Math.min(a,o)));return l%2==1&&(l+=1),n.polygon(e,t,l,o,i.extend({},s,r))},n.polygon=function(e,t,o,s,l){if(l=l||{},o<3)return n.circle(e,t,s,l);for(var c=2*Math.PI/o,d="",u=.5*c,h=0;h<o;h+=1){var f=u+h*c,p=Math.cos(f)*s,v=Math.sin(f)*s;d+="L "+p.toFixed(3)+" "+v.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:e,y:t},vertices:r.fromPath(d)};if(l.chamfer){var g=l.chamfer;y.vertices=r.chamfer(y.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete l.chamfer}return a.create(i.extend({},y,l))},n.fromVertices=function(e,t,o,n,c,d,u,h){var f,p,v,y,g,m,x,b,M,S,A=i.getDecomp();for(f=Boolean(A&&A.quickDecomp),n=n||{},v=[],c=void 0!==c&&c,d=void 0!==d?d:.01,u=void 0!==u?u:10,h=void 0!==h?h:.01,i.isArray(o[0])||(o=[o]),M=0;M<o.length;M+=1)if(g=o[M],!(y=r.isConvex(g))&&!f&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),y||!f)g=y?r.clockwiseSort(g):r.hull(g),v.push({position:{x:e,y:t},vertices:g});else{var P=g.map((function(e){return[e.x,e.y]}));A.makeCCW(P),!1!==d&&A.removeCollinearPoints(P,d),!1!==h&&A.removeDuplicatePoints&&A.removeDuplicatePoints(P,h);var w=A.quickDecomp(P);for(m=0;m<w.length;m++){var C=w[m].map((function(e){return{x:e[0],y:e[1]}}));u>0&&r.area(C)<u||v.push({position:r.centre(C),vertices:C})}}for(m=0;m<v.length;m++)v[m]=a.create(i.extend(v[m],n));if(c)for(m=0;m<v.length;m++){var k=v[m];for(x=m+1;x<v.length;x++){var I=v[x];if(s.overlaps(k.bounds,I.bounds)){var F=k.vertices,T=I.vertices;for(b=0;b<k.vertices.length;b++)for(S=0;S<I.vertices.length;S++){var B=l.magnitudeSquared(l.sub(F[(b+1)%F.length],T[S])),R=l.magnitudeSquared(l.sub(F[b],T[(S+1)%T.length]));B<5&&R<5&&(F[b].isInternal=!0,T[S].isInternal=!0)}}}}return v.length>1?(p=a.create(i.extend({parts:v.slice(0)},n)),a.setPosition(p,{x:e,y:t}),p):v[0]}},function(e,t,o){var n={};e.exports=n;var r=o(0),i=o(8);n.create=function(e){return r.extend({bodies:[],pairs:null},e)},n.setBodies=function(e,t){e.bodies=t.slice(0)},n.clear=function(e){e.bodies=[]},n.collisions=function(e){var t,o,r=[],a=e.pairs,s=e.bodies,l=s.length,c=n.canCollide,d=i.collides;for(s.sort(n._compareBoundsX),t=0;t<l;t++){var u=s[t],h=u.bounds,f=u.bounds.max.x,p=u.bounds.max.y,v=u.bounds.min.y,y=u.isStatic||u.isSleeping,g=u.parts.length,m=1===g;for(o=t+1;o<l;o++){var x=s[o];if((k=x.bounds).min.x>f)break;if(!(p<k.min.y||v>k.max.y)&&(!y||!x.isStatic&&!x.isSleeping)&&c(u.collisionFilter,x.collisionFilter)){var b=x.parts.length;if(m&&1===b)(w=d(u,x,a))&&r.push(w);else for(var M=b>1?1:0,S=g>1?1:0;S<g;S++)for(var A=u.parts[S],P=(h=A.bounds,M);P<b;P++){var w,C=x.parts[P],k=C.bounds;h.min.x>k.max.x||h.max.x<k.min.x||h.max.y<k.min.y||h.min.y>k.max.y||(w=d(A,C,a))&&r.push(w)}}}}return r},n.canCollide=function(e,t){return e.group===t.group&&0!==e.group?e.group>0:!!(e.mask&t.category)&&!!(t.mask&e.category)},n._compareBoundsX=function(e,t){return e.bounds.min.x-t.bounds.min.x}},function(e,t,o){var n={};e.exports=n;var r=o(0);n.create=function(e){var t={};return e||r.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=parseInt(t.element.getAttribute("data-pixel-ratio"),10)||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var o=n._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&(t.button=0,e.preventDefault()),t.absolute.x=o.x,t.absolute.y=o.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var o=n._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=o.x,t.absolute.y=o.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var o=n._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&e.preventDefault(),t.button=-1,t.absolute.x=o.x,t.absolute.y=o.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},n.setElement(t,t.element),t},n.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},n.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},n.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},n.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},n._getRelativeMousePosition=function(e,t,o){var n,r,i=t.getBoundingClientRect(),a=document.documentElement||document.body.parentNode||document.body,s=void 0!==window.pageXOffset?window.pageXOffset:a.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:a.scrollTop,c=e.changedTouches;return c?(n=c[0].pageX-i.left-s,r=c[0].pageY-i.top-l):(n=e.pageX-i.left-s,r=e.pageY-i.top-l),{x:n/(t.clientWidth/(t.width||t.clientWidth)*o),y:r/(t.clientHeight/(t.height||t.clientHeight)*o)}}},function(e,t,o){var n={};e.exports=n;var r=o(0);n._registry={},n.register=function(e){if(n.isPlugin(e)||r.warn("Plugin.register:",n.toString(e),"does not implement all required fields."),e.name in n._registry){var t=n._registry[e.name],o=n.versionParse(e.version).number,i=n.versionParse(t.version).number;o>i?(r.warn("Plugin.register:",n.toString(t),"was upgraded to",n.toString(e)),n._registry[e.name]=e):o<i?r.warn("Plugin.register:",n.toString(t),"can not be downgraded to",n.toString(e)):e!==t&&r.warn("Plugin.register:",n.toString(e),"is already registered to different plugin object")}else n._registry[e.name]=e;return e},n.resolve=function(e){return n._registry[n.dependencyParse(e).name]},n.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},n.isPlugin=function(e){return e&&e.name&&e.version&&e.install},n.isUsed=function(e,t){return e.used.indexOf(t)>-1},n.isFor=function(e,t){var o=e.for&&n.dependencyParse(e.for);return!e.for||t.name===o.name&&n.versionSatisfies(t.version,o.range)},n.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var o=n.dependencies(e),i=r.topologicalSort(o),a=[],s=0;s<i.length;s+=1)if(i[s]!==e.name){var l=n.resolve(i[s]);l?n.isUsed(e,l.name)||(n.isFor(l,e)||(r.warn("Plugin.use:",n.toString(l),"is for",l.for,"but installed on",n.toString(e)+"."),l._warned=!0),l.install?l.install(e):(r.warn("Plugin.use:",n.toString(l),"does not specify an install function."),l._warned=!0),l._warned?(a.push("🔶 "+n.toString(l)),delete l._warned):a.push("✅ "+n.toString(l)),e.used.push(l.name)):a.push("❌ "+i[s])}a.length>0&&r.info(a.join("  "))}else r.warn("Plugin.use:",n.toString(e),"does not specify any dependencies to install.")},n.dependencies=function(e,t){var o=n.dependencyParse(e),i=o.name;if(!(i in(t=t||{}))){e=n.resolve(e)||e,t[i]=r.map(e.uses||[],(function(t){n.isPlugin(t)&&n.register(t);var i=n.dependencyParse(t),a=n.resolve(t);return a&&!n.versionSatisfies(a.version,i.range)?(r.warn("Plugin.dependencies:",n.toString(a),"does not satisfy",n.toString(i),"used by",n.toString(o)+"."),a._warned=!0,e._warned=!0):a||(r.warn("Plugin.dependencies:",n.toString(t),"used by",n.toString(o),"could not be resolved."),e._warned=!0),i.name}));for(var a=0;a<t[i].length;a+=1)n.dependencies(t[i][a],t);return t}},n.dependencyParse=function(e){return r.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(e)||r.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},n.versionParse=function(e){var t=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;t.test(e)||r.warn("Plugin.versionParse:",e,"is not a valid version or range.");var o=t.exec(e),n=Number(o[4]),i=Number(o[5]),a=Number(o[6]);return{isRange:Boolean(o[1]||o[2]),version:o[3],range:e,operator:o[1]||o[2]||"",major:n,minor:i,patch:a,parts:[n,i,a],prerelease:o[7],number:1e8*n+1e4*i+a}},n.versionSatisfies=function(e,t){t=t||"*";var o=n.versionParse(t),r=n.versionParse(e);if(o.isRange){if("*"===o.operator||"*"===e)return!0;if(">"===o.operator)return r.number>o.number;if(">="===o.operator)return r.number>=o.number;if("~"===o.operator)return r.major===o.major&&r.minor===o.minor&&r.patch>=o.patch;if("^"===o.operator)return o.major>0?r.major===o.major&&r.number>=o.number:o.minor>0?r.minor===o.minor&&r.patch>=o.patch:r.patch===o.patch}return e===t||"*"===e}},function(e,t){var o={};e.exports=o,o.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}},function(e,t,o){var n={};e.exports=n;var r=o(7),i=o(18),a=o(13),s=o(19),l=o(5),c=o(6),d=o(10),u=o(0),h=o(4);n.create=function(e){e=e||{};var t=u.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},e);return t.world=e.world||c.create({label:"World"}),t.pairs=e.pairs||s.create(),t.detector=e.detector||a.create(),t.grid={buckets:[]},t.world.gravity=t.gravity,t.broadphase=t.grid,t.metrics={},t},n.update=function(e,t){var o,h=u.now(),f=e.world,p=e.detector,v=e.pairs,y=e.timing,g=y.timestamp;t=void 0!==t?t:u._baseDelta,t*=y.timeScale,y.timestamp+=t,y.lastDelta=t;var m={timestamp:y.timestamp,delta:t};l.trigger(e,"beforeUpdate",m);var x=c.allBodies(f),b=c.allConstraints(f);for(f.isModified&&(a.setBodies(p,x),c.setModified(f,!1,!1,!0)),e.enableSleeping&&r.update(x,t),n._bodiesApplyGravity(x,e.gravity),t>0&&n._bodiesUpdate(x,t),d.preSolveAll(x),o=0;o<e.constraintIterations;o++)d.solveAll(b,t);d.postSolveAll(x),p.pairs=e.pairs;var M=a.collisions(p);s.update(v,M,g),e.enableSleeping&&r.afterCollisions(v.list),v.collisionStart.length>0&&l.trigger(e,"collisionStart",{pairs:v.collisionStart});var S=u.clamp(20/e.positionIterations,0,1);for(i.preSolvePosition(v.list),o=0;o<e.positionIterations;o++)i.solvePosition(v.list,t,S);for(i.postSolvePosition(x),d.preSolveAll(x),o=0;o<e.constraintIterations;o++)d.solveAll(b,t);for(d.postSolveAll(x),i.preSolveVelocity(v.list),o=0;o<e.velocityIterations;o++)i.solveVelocity(v.list,t);return n._bodiesUpdateVelocities(x),v.collisionActive.length>0&&l.trigger(e,"collisionActive",{pairs:v.collisionActive}),v.collisionEnd.length>0&&l.trigger(e,"collisionEnd",{pairs:v.collisionEnd}),n._bodiesClearForces(x),l.trigger(e,"afterUpdate",m),e.timing.lastElapsed=u.now()-h,e},n.merge=function(e,t){if(u.extend(e,t),t.world){e.world=t.world,n.clear(e);for(var o=c.allBodies(e.world),i=0;i<o.length;i++){var a=o[i];r.set(a,!1),a.id=u.nextId()}}},n.clear=function(e){s.clear(e.pairs),a.clear(e.detector)},n._bodiesClearForces=function(e){for(var t=e.length,o=0;o<t;o++){var n=e[o];n.force.x=0,n.force.y=0,n.torque=0}},n._bodiesApplyGravity=function(e,t){var o=void 0!==t.scale?t.scale:.001,n=e.length;if((0!==t.x||0!==t.y)&&0!==o)for(var r=0;r<n;r++){var i=e[r];i.isStatic||i.isSleeping||(i.force.y+=i.mass*t.y*o,i.force.x+=i.mass*t.x*o)}},n._bodiesUpdate=function(e,t){for(var o=e.length,n=0;n<o;n++){var r=e[n];r.isStatic||r.isSleeping||h.update(r,t)}},n._bodiesUpdateVelocities=function(e){for(var t=e.length,o=0;o<t;o++)h.updateVelocities(e[o])}},function(e,t,o){var n={};e.exports=n;var r=o(3),i=o(0),a=o(1);n._restingThresh=2,n._restingThreshTangent=Math.sqrt(6),n._positionDampen=.9,n._positionWarming=.8,n._frictionNormalMultiplier=5,n._frictionMaxStatic=Number.MAX_VALUE,n.preSolvePosition=function(e){var t,o,n,r=e.length;for(t=0;t<r;t++)(o=e[t]).isActive&&(n=o.activeContacts.length,o.collision.parentA.totalContacts+=n,o.collision.parentB.totalContacts+=n)},n.solvePosition=function(e,t,o){var r,a,s,l,c,d,u,h,f=n._positionDampen*(o||1),p=i.clamp(t/i._baseDelta,0,1),v=e.length;for(r=0;r<v;r++)(a=e[r]).isActive&&!a.isSensor&&(l=(s=a.collision).parentA,c=s.parentB,d=s.normal,a.separation=d.x*(c.positionImpulse.x+s.penetration.x-l.positionImpulse.x)+d.y*(c.positionImpulse.y+s.penetration.y-l.positionImpulse.y));for(r=0;r<v;r++)(a=e[r]).isActive&&!a.isSensor&&(l=(s=a.collision).parentA,c=s.parentB,d=s.normal,h=a.separation-a.slop*p,(l.isStatic||c.isStatic)&&(h*=2),l.isStatic||l.isSleeping||(u=f/l.totalContacts,l.positionImpulse.x+=d.x*h*u,l.positionImpulse.y+=d.y*h*u),c.isStatic||c.isSleeping||(u=f/c.totalContacts,c.positionImpulse.x-=d.x*h*u,c.positionImpulse.y-=d.y*h*u))},n.postSolvePosition=function(e){for(var t=n._positionWarming,o=e.length,i=r.translate,s=a.update,l=0;l<o;l++){var c=e[l],d=c.positionImpulse,u=d.x,h=d.y,f=c.velocity;if(c.totalContacts=0,0!==u||0!==h){for(var p=0;p<c.parts.length;p++){var v=c.parts[p];i(v.vertices,d),s(v.bounds,v.vertices,f),v.position.x+=u,v.position.y+=h}c.positionPrev.x+=u,c.positionPrev.y+=h,u*f.x+h*f.y<0?(d.x=0,d.y=0):(d.x*=t,d.y*=t)}}},n.preSolveVelocity=function(e){var t,o,n=e.length;for(t=0;t<n;t++){var r=e[t];if(r.isActive&&!r.isSensor){var i=r.activeContacts,a=i.length,s=r.collision,l=s.parentA,c=s.parentB,d=s.normal,u=s.tangent;for(o=0;o<a;o++){var h=i[o],f=h.vertex,p=h.normalImpulse,v=h.tangentImpulse;if(0!==p||0!==v){var y=d.x*p+u.x*v,g=d.y*p+u.y*v;l.isStatic||l.isSleeping||(l.positionPrev.x+=y*l.inverseMass,l.positionPrev.y+=g*l.inverseMass,l.anglePrev+=l.inverseInertia*((f.x-l.position.x)*g-(f.y-l.position.y)*y)),c.isStatic||c.isSleeping||(c.positionPrev.x-=y*c.inverseMass,c.positionPrev.y-=g*c.inverseMass,c.anglePrev-=c.inverseInertia*((f.x-c.position.x)*g-(f.y-c.position.y)*y))}}}}},n.solveVelocity=function(e,t){var o,r,a,s,l=t/i._baseDelta,c=l*l*l,d=-n._restingThresh*l,u=n._restingThreshTangent,h=n._frictionNormalMultiplier*l,f=n._frictionMaxStatic,p=e.length;for(a=0;a<p;a++){var v=e[a];if(v.isActive&&!v.isSensor){var y=v.collision,g=y.parentA,m=y.parentB,x=g.velocity,b=m.velocity,M=y.normal.x,S=y.normal.y,A=y.tangent.x,P=y.tangent.y,w=v.activeContacts,C=w.length,k=1/C,I=g.inverseMass+m.inverseMass,F=v.friction*v.frictionStatic*h;for(x.x=g.position.x-g.positionPrev.x,x.y=g.position.y-g.positionPrev.y,b.x=m.position.x-m.positionPrev.x,b.y=m.position.y-m.positionPrev.y,g.angularVelocity=g.angle-g.anglePrev,m.angularVelocity=m.angle-m.anglePrev,s=0;s<C;s++){var T=w[s],B=T.vertex,R=B.x-g.position.x,_=B.y-g.position.y,L=B.x-m.position.x,E=B.y-m.position.y,V=x.x-_*g.angularVelocity,D=x.y+R*g.angularVelocity,O=V-(b.x-E*m.angularVelocity),z=D-(b.y+L*m.angularVelocity),W=M*O+S*z,G=A*O+P*z,q=v.separation+W,j=Math.min(q,1),H=(j=q<0?0:j)*F;G<-H||G>H?(r=G>0?G:-G,(o=v.friction*(G>0?1:-1)*c)<-r?o=-r:o>r&&(o=r)):(o=G,r=f);var N=R*S-_*M,U=L*S-E*M,Q=k/(I+g.inverseInertia*N*N+m.inverseInertia*U*U),X=(1+v.restitution)*W*Q;if(o*=Q,W<d)T.normalImpulse=0;else{var Z=T.normalImpulse;T.normalImpulse+=X,T.normalImpulse>0&&(T.normalImpulse=0),X=T.normalImpulse-Z}if(G<-u||G>u)T.tangentImpulse=0;else{var Y=T.tangentImpulse;T.tangentImpulse+=o,T.tangentImpulse<-r&&(T.tangentImpulse=-r),T.tangentImpulse>r&&(T.tangentImpulse=r),o=T.tangentImpulse-Y}var K=M*X+A*o,$=S*X+P*o;g.isStatic||g.isSleeping||(g.positionPrev.x+=K*g.inverseMass,g.positionPrev.y+=$*g.inverseMass,g.anglePrev+=(R*$-_*K)*g.inverseInertia),m.isStatic||m.isSleeping||(m.positionPrev.x-=K*m.inverseMass,m.positionPrev.y-=$*m.inverseMass,m.anglePrev-=(L*$-E*K)*m.inverseInertia)}}}}},function(e,t,o){var n={};e.exports=n;var r=o(9),i=o(0);n.create=function(e){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},n.update=function(e,t,o){var n,i,a,s,l=e.list,c=l.length,d=e.table,u=t.length,h=e.collisionStart,f=e.collisionEnd,p=e.collisionActive;for(h.length=0,f.length=0,p.length=0,s=0;s<c;s++)l[s].confirmedActive=!1;for(s=0;s<u;s++)(a=(n=t[s]).pair)?(a.isActive?p.push(a):h.push(a),r.update(a,n,o),a.confirmedActive=!0):(d[(a=r.create(n,o)).id]=a,h.push(a),l.push(a));var v=[];for(c=l.length,s=0;s<c;s++)(a=l[s]).confirmedActive||(r.setActive(a,!1,o),f.push(a),a.collision.bodyA.isSleeping||a.collision.bodyB.isSleeping||v.push(s));for(s=0;s<v.length;s++)a=l[i=v[s]-s],l.splice(i,1),delete d[a.id]},n.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},function(e,t,o){var n=e.exports=o(21);n.Axes=o(11),n.Bodies=o(12),n.Body=o(4),n.Bounds=o(1),n.Collision=o(8),n.Common=o(0),n.Composite=o(6),n.Composites=o(22),n.Constraint=o(10),n.Contact=o(16),n.Detector=o(13),n.Engine=o(17),n.Events=o(5),n.Grid=o(23),n.Mouse=o(14),n.MouseConstraint=o(24),n.Pair=o(9),n.Pairs=o(19),n.Plugin=o(15),n.Query=o(25),n.Render=o(26),n.Resolver=o(18),n.Runner=o(27),n.SAT=o(28),n.Sleeping=o(7),n.Svg=o(29),n.Vector=o(2),n.Vertices=o(3),n.World=o(30),n.Engine.run=n.Runner.run,n.Common.deprecated(n.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(e,t,o){var n={};e.exports=n;var r=o(15),i=o(0);n.name="matter-js",n.version="0.19.0",n.uses=[],n.used=[],n.use=function(){r.use(n,Array.prototype.slice.call(arguments))},n.before=function(e,t){return e=e.replace(/^Matter./,""),i.chainPathBefore(n,e,t)},n.after=function(e,t){return e=e.replace(/^Matter./,""),i.chainPathAfter(n,e,t)}},function(e,t,o){var n={};e.exports=n;var r=o(6),i=o(10),a=o(0),s=o(4),l=o(12),c=a.deprecated;n.stack=function(e,t,o,n,i,a,l){for(var c,d=r.create({label:"Stack"}),u=e,h=t,f=0,p=0;p<n;p++){for(var v=0,y=0;y<o;y++){var g=l(u,h,y,p,c,f);if(g){var m=g.bounds.max.y-g.bounds.min.y,x=g.bounds.max.x-g.bounds.min.x;m>v&&(v=m),s.translate(g,{x:.5*x,y:.5*m}),u=g.bounds.max.x+i,r.addBody(d,g),c=g,f+=1}else u+=i}h+=v+a,u=e}return d},n.chain=function(e,t,o,n,s,l){for(var c=e.bodies,d=1;d<c.length;d++){var u=c[d-1],h=c[d],f=u.bounds.max.y-u.bounds.min.y,p=u.bounds.max.x-u.bounds.min.x,v=h.bounds.max.y-h.bounds.min.y,y={bodyA:u,pointA:{x:p*t,y:f*o},bodyB:h,pointB:{x:(h.bounds.max.x-h.bounds.min.x)*n,y:v*s}},g=a.extend(y,l);r.addConstraint(e,i.create(g))}return e.label+=" Chain",e},n.mesh=function(e,t,o,n,s){var l,c,d,u,h,f=e.bodies;for(l=0;l<o;l++){for(c=1;c<t;c++)d=f[c-1+l*t],u=f[c+l*t],r.addConstraint(e,i.create(a.extend({bodyA:d,bodyB:u},s)));if(l>0)for(c=0;c<t;c++)d=f[c+(l-1)*t],u=f[c+l*t],r.addConstraint(e,i.create(a.extend({bodyA:d,bodyB:u},s))),n&&c>0&&(h=f[c-1+(l-1)*t],r.addConstraint(e,i.create(a.extend({bodyA:h,bodyB:u},s)))),n&&c<t-1&&(h=f[c+1+(l-1)*t],r.addConstraint(e,i.create(a.extend({bodyA:h,bodyB:u},s))))}return e.label+=" Mesh",e},n.pyramid=function(e,t,o,r,i,a,l){return n.stack(e,t,o,r,i,a,(function(t,n,a,c,d,u){var h=Math.min(r,Math.ceil(o/2)),f=d?d.bounds.max.x-d.bounds.min.x:0;if(!(c>h||a<(c=h-c)||a>o-1-c))return 1===u&&s.translate(d,{x:(a+(o%2==1?1:-1))*f,y:0}),l(e+(d?a*f:0)+a*i,n,a,c,d,u)}))},n.newtonsCradle=function(e,t,o,n,a){for(var s=r.create({label:"Newtons Cradle"}),c=0;c<o;c++){var d=l.circle(e+c*(1.9*n),t+a,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=i.create({pointA:{x:e+c*(1.9*n),y:t},bodyB:d});r.addBody(s,d),r.addConstraint(s,u)}return s},c(n,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),n.car=function(e,t,o,n,a){var c=s.nextGroup(!0),d=.5*-o+20,u=.5*o-20,h=r.create({label:"Car"}),f=l.rectangle(e,t,o,n,{collisionFilter:{group:c},chamfer:{radius:.5*n},density:2e-4}),p=l.circle(e+d,t+0,a,{collisionFilter:{group:c},friction:.8}),v=l.circle(e+u,t+0,a,{collisionFilter:{group:c},friction:.8}),y=i.create({bodyB:f,pointB:{x:d,y:0},bodyA:p,stiffness:1,length:0}),g=i.create({bodyB:f,pointB:{x:u,y:0},bodyA:v,stiffness:1,length:0});return r.addBody(h,f),r.addBody(h,p),r.addBody(h,v),r.addConstraint(h,y),r.addConstraint(h,g),h},c(n,"car","Composites.car ➤ moved to car example"),n.softBody=function(e,t,o,r,i,s,c,d,u,h){u=a.extend({inertia:1/0},u),h=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},h);var f=n.stack(e,t,o,r,i,s,(function(e,t){return l.circle(e,t,d,u)}));return n.mesh(f,o,r,c,h),f.label="Soft Body",f},c(n,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function(e,t,o){var n={};e.exports=n;var r=o(9),i=o(0),a=i.deprecated;n.create=function(e){return i.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},e)},n.update=function(e,t,o,r){var i,a,s,l,c,d=o.world,u=e.buckets,h=!1;for(i=0;i<t.length;i++){var f=t[i];if((!f.isSleeping||r)&&(!d.bounds||!(f.bounds.max.x<d.bounds.min.x||f.bounds.min.x>d.bounds.max.x||f.bounds.max.y<d.bounds.min.y||f.bounds.min.y>d.bounds.max.y))){var p=n._getRegion(e,f);if(!f.region||p.id!==f.region.id||r){f.region&&!r||(f.region=p);var v=n._regionUnion(p,f.region);for(a=v.startCol;a<=v.endCol;a++)for(s=v.startRow;s<=v.endRow;s++){l=u[c=n._getBucketId(a,s)];var y=a>=p.startCol&&a<=p.endCol&&s>=p.startRow&&s<=p.endRow,g=a>=f.region.startCol&&a<=f.region.endCol&&s>=f.region.startRow&&s<=f.region.endRow;!y&&g&&g&&l&&n._bucketRemoveBody(e,l,f),(f.region===p||y&&!g||r)&&(l||(l=n._createBucket(u,c)),n._bucketAddBody(e,l,f))}f.region=p,h=!0}}}h&&(e.pairsList=n._createActivePairsList(e))},a(n,"update","Grid.update ➤ replaced by Matter.Detector"),n.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},a(n,"clear","Grid.clear ➤ replaced by Matter.Detector"),n._regionUnion=function(e,t){var o=Math.min(e.startCol,t.startCol),r=Math.max(e.endCol,t.endCol),i=Math.min(e.startRow,t.startRow),a=Math.max(e.endRow,t.endRow);return n._createRegion(o,r,i,a)},n._getRegion=function(e,t){var o=t.bounds,r=Math.floor(o.min.x/e.bucketWidth),i=Math.floor(o.max.x/e.bucketWidth),a=Math.floor(o.min.y/e.bucketHeight),s=Math.floor(o.max.y/e.bucketHeight);return n._createRegion(r,i,a,s)},n._createRegion=function(e,t,o,n){return{id:e+","+t+","+o+","+n,startCol:e,endCol:t,startRow:o,endRow:n}},n._getBucketId=function(e,t){return"C"+e+"R"+t},n._createBucket=function(e,t){return e[t]=[]},n._bucketAddBody=function(e,t,o){var n,i=e.pairs,a=r.id,s=t.length;for(n=0;n<s;n++){var l=t[n];if(!(o.id===l.id||o.isStatic&&l.isStatic)){var c=a(o,l),d=i[c];d?d[2]+=1:i[c]=[o,l,1]}}t.push(o)},n._bucketRemoveBody=function(e,t,o){var n,a=e.pairs,s=r.id;t.splice(i.indexOf(t,o),1);var l=t.length;for(n=0;n<l;n++){var c=a[s(o,t[n])];c&&(c[2]-=1)}},n._createActivePairsList=function(e){var t,o,n=e.pairs,r=i.keys(n),a=r.length,s=[];for(o=0;o<a;o++)(t=n[r[o]])[2]>0?s.push(t):delete n[r[o]];return s}},function(e,t,o){var n={};e.exports=n;var r=o(3),i=o(7),a=o(14),s=o(5),l=o(13),c=o(10),d=o(6),u=o(0),h=o(1);n.create=function(e,t){var o=(e?e.mouse:null)||(t?t.mouse:null);o||(e&&e.render&&e.render.canvas?o=a.create(e.render.canvas):t&&t.element?o=a.create(t.element):(o=a.create(),u.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var r={type:"mouseConstraint",mouse:o,element:null,body:null,constraint:c.create({label:"Mouse Constraint",pointA:o.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},i=u.extend(r,t);return s.on(e,"beforeUpdate",(function(){var t=d.allBodies(e.world);n.update(i,t),n._triggerEvents(i)})),i},n.update=function(e,t){var o=e.mouse,n=e.constraint,a=e.body;if(0===o.button){if(n.bodyB)i.set(n.bodyB,!1),n.pointA=o.position;else for(var c=0;c<t.length;c++)if(a=t[c],h.contains(a.bounds,o.position)&&l.canCollide(a.collisionFilter,e.collisionFilter))for(var d=a.parts.length>1?1:0;d<a.parts.length;d++){var u=a.parts[d];if(r.contains(u.vertices,o.position)){n.pointA=o.position,n.bodyB=e.body=a,n.pointB={x:o.position.x-a.position.x,y:o.position.y-a.position.y},n.angleB=a.angle,i.set(a,!1),s.trigger(e,"startdrag",{mouse:o,body:a});break}}}else n.bodyB=e.body=null,n.pointB=null,a&&s.trigger(e,"enddrag",{mouse:o,body:a})},n._triggerEvents=function(e){var t=e.mouse,o=t.sourceEvents;o.mousemove&&s.trigger(e,"mousemove",{mouse:t}),o.mousedown&&s.trigger(e,"mousedown",{mouse:t}),o.mouseup&&s.trigger(e,"mouseup",{mouse:t}),a.clearSourceEvents(t)}},function(e,t,o){var n={};e.exports=n;var r=o(2),i=o(8),a=o(1),s=o(12),l=o(3);n.collides=function(e,t){for(var o=[],n=t.length,r=e.bounds,s=i.collides,l=a.overlaps,c=0;c<n;c++){var d=t[c],u=d.parts.length,h=1===u?0:1;if(l(d.bounds,r))for(var f=h;f<u;f++){var p=d.parts[f];if(l(p.bounds,r)){var v=s(p,e);if(v){o.push(v);break}}}}return o},n.ray=function(e,t,o,i){i=i||1e-100;for(var a=r.angle(t,o),l=r.magnitude(r.sub(t,o)),c=.5*(o.x+t.x),d=.5*(o.y+t.y),u=s.rectangle(c,d,l,i,{angle:a}),h=n.collides(u,e),f=0;f<h.length;f+=1){var p=h[f];p.body=p.bodyB=p.bodyA}return h},n.region=function(e,t,o){for(var n=[],r=0;r<e.length;r++){var i=e[r],s=a.overlaps(i.bounds,t);(s&&!o||!s&&o)&&n.push(i)}return n},n.point=function(e,t){for(var o=[],n=0;n<e.length;n++){var r=e[n];if(a.contains(r.bounds,t))for(var i=1===r.parts.length?0:1;i<r.parts.length;i++){var s=r.parts[i];if(a.contains(s.bounds,t)&&l.contains(s.vertices,t)){o.push(r);break}}}return o}},function(e,t,o){var n={};e.exports=n;var r=o(4),i=o(0),a=o(6),s=o(1),l=o(5),c=o(2),d=o(14);!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout((function(){e(i.now())}),1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),n._goodFps=30,n._goodDelta=1e3/60,n.create=function(e){var t={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},o=i.extend(t,e);return o.canvas&&(o.canvas.width=o.options.width||o.canvas.width,o.canvas.height=o.options.height||o.canvas.height),o.mouse=e.mouse,o.engine=e.engine,o.canvas=o.canvas||h(o.options.width,o.options.height),o.context=o.canvas.getContext("2d"),o.textures={},o.bounds=o.bounds||{min:{x:0,y:0},max:{x:o.canvas.width,y:o.canvas.height}},o.controller=n,o.options.showBroadphase=!1,1!==o.options.pixelRatio&&n.setPixelRatio(o,o.options.pixelRatio),i.isElement(o.element)&&o.element.appendChild(o.canvas),o},n.run=function(t){!function r(i){t.frameRequestId=e(r),o(t,i),n.world(t,i),(t.options.showStats||t.options.showDebug)&&n.stats(t,t.context,i),(t.options.showPerformance||t.options.showDebug)&&n.performance(t,t.context,i)}()},n.stop=function(e){t(e.frameRequestId)},n.setPixelRatio=function(e,t){var o=e.options,n=e.canvas;"auto"===t&&(t=f(n)),o.pixelRatio=t,n.setAttribute("data-pixel-ratio",t),n.width=o.width*t,n.height=o.height*t,n.style.width=o.width+"px",n.style.height=o.height+"px"},n.lookAt=function(e,t,o,n){n=void 0===n||n,t=i.isArray(t)?t:[t],o=o||{x:0,y:0};for(var r={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},a=0;a<t.length;a+=1){var s=t[a],l=s.bounds?s.bounds.min:s.min||s.position||s,c=s.bounds?s.bounds.max:s.max||s.position||s;l&&c&&(l.x<r.min.x&&(r.min.x=l.x),c.x>r.max.x&&(r.max.x=c.x),l.y<r.min.y&&(r.min.y=l.y),c.y>r.max.y&&(r.max.y=c.y))}var u=r.max.x-r.min.x+2*o.x,h=r.max.y-r.min.y+2*o.y,f=e.canvas.height,p=e.canvas.width/f,v=u/h,y=1,g=1;v>p?g=v/p:y=p/v,e.options.hasBounds=!0,e.bounds.min.x=r.min.x,e.bounds.max.x=r.min.x+u*y,e.bounds.min.y=r.min.y,e.bounds.max.y=r.min.y+h*g,n&&(e.bounds.min.x+=.5*u-u*y*.5,e.bounds.max.x+=.5*u-u*y*.5,e.bounds.min.y+=.5*h-h*g*.5,e.bounds.max.y+=.5*h-h*g*.5),e.bounds.min.x-=o.x,e.bounds.max.x-=o.x,e.bounds.min.y-=o.y,e.bounds.max.y-=o.y,e.mouse&&(d.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),d.setOffset(e.mouse,e.bounds.min))},n.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,o=e.bounds.max.y-e.bounds.min.y,n=t/e.options.width,r=o/e.options.height;e.context.setTransform(e.options.pixelRatio/n,0,0,e.options.pixelRatio/r,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},n.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},n.world=function(e,t){var o,r=i.now(),u=e.engine,h=u.world,f=e.canvas,p=e.context,y=e.options,g=e.timing,m=a.allBodies(h),x=a.allConstraints(h),b=y.wireframes?y.wireframeBackground:y.background,M=[],S=[],A={timestamp:u.timing.timestamp};if(l.trigger(e,"beforeRender",A),e.currentBackground!==b&&v(e,b),p.globalCompositeOperation="source-in",p.fillStyle="transparent",p.fillRect(0,0,f.width,f.height),p.globalCompositeOperation="source-over",y.hasBounds){for(o=0;o<m.length;o++){var P=m[o];s.overlaps(P.bounds,e.bounds)&&M.push(P)}for(o=0;o<x.length;o++){var w=x[o],C=w.bodyA,k=w.bodyB,I=w.pointA,F=w.pointB;C&&(I=c.add(C.position,w.pointA)),k&&(F=c.add(k.position,w.pointB)),I&&F&&(s.contains(e.bounds,I)||s.contains(e.bounds,F))&&S.push(w)}n.startViewTransform(e),e.mouse&&(d.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.options.width,y:(e.bounds.max.y-e.bounds.min.y)/e.options.height}),d.setOffset(e.mouse,e.bounds.min))}else S=x,M=m,1!==e.options.pixelRatio&&e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0);!y.wireframes||u.enableSleeping&&y.showSleeping?n.bodies(e,M,p):(y.showConvexHulls&&n.bodyConvexHulls(e,M,p),n.bodyWireframes(e,M,p)),y.showBounds&&n.bodyBounds(e,M,p),(y.showAxes||y.showAngleIndicator)&&n.bodyAxes(e,M,p),y.showPositions&&n.bodyPositions(e,M,p),y.showVelocity&&n.bodyVelocity(e,M,p),y.showIds&&n.bodyIds(e,M,p),y.showSeparations&&n.separations(e,u.pairs.list,p),y.showCollisions&&n.collisions(e,u.pairs.list,p),y.showVertexNumbers&&n.vertexNumbers(e,M,p),y.showMousePosition&&n.mousePosition(e,e.mouse,p),n.constraints(S,p),y.hasBounds&&n.endViewTransform(e),l.trigger(e,"afterRender",A),g.lastElapsed=i.now()-r},n.stats=function(e,t,o){for(var n=e.engine,r=n.world,i=a.allBodies(r),s=0,l=0,c=0;c<i.length;c+=1)s+=i[c].parts.length;var d={Part:s,Body:i.length,Cons:a.allConstraints(r).length,Comp:a.allComposites(r).length,Pair:n.pairs.list.length};for(var u in t.fillStyle="#0e0f19",t.fillRect(l,0,302.5,44),t.font="12px Arial",t.textBaseline="top",t.textAlign="right",d){var h=d[u];t.fillStyle="#aaa",t.fillText(u,l+55,8),t.fillStyle="#eee",t.fillText(h,l+55,26),l+=55}},n.performance=function(e,t){var o=e.engine,r=e.timing,i=r.deltaHistory,a=r.elapsedHistory,s=r.timestampElapsedHistory,l=r.engineDeltaHistory,c=r.engineElapsedHistory,d=o.timing.lastDelta,h=u(i),f=u(a),p=u(l),v=u(c),y=u(s)/h||0,g=1e3/h||0;t.fillStyle="#0e0f19",t.fillRect(0,50,370,34),n.status(t,10,69,60,4,i.length,Math.round(g)+" fps",g/n._goodFps,(function(e){return i[e]/h-1})),n.status(t,82,69,60,4,l.length,d.toFixed(2)+" dt",n._goodDelta/d,(function(e){return l[e]/p-1})),n.status(t,154,69,60,4,c.length,v.toFixed(2)+" ut",1-v/n._goodFps,(function(e){return c[e]/v-1})),n.status(t,226,69,60,4,a.length,f.toFixed(2)+" rt",1-f/n._goodFps,(function(e){return a[e]/f-1})),n.status(t,298,69,60,4,s.length,y.toFixed(2)+" x",y*y*y,(function(e){return(s[e]/i[e]/y||0)-1}))},n.status=function(e,t,o,n,r,a,s,l,c){e.strokeStyle="#888",e.fillStyle="#444",e.lineWidth=1,e.fillRect(t,o+7,n,1),e.beginPath(),e.moveTo(t,o+7-r*i.clamp(.4*c(0),-2,2));for(var d=0;d<n;d+=1)e.lineTo(t+d,o+7-(d<a?r*i.clamp(.4*c(d),-2,2):0));e.stroke(),e.fillStyle="hsl("+i.clamp(25+95*l,0,120)+",100%,60%)",e.fillRect(t,o-7,4,4),e.font="12px Arial",e.textBaseline="middle",e.textAlign="right",e.fillStyle="#eee",e.fillText(s,t+n,o-5)},n.constraints=function(e,t){for(var o=t,n=0;n<e.length;n++){var r=e[n];if(r.render.visible&&r.pointA&&r.pointB){var a,s,l=r.bodyA,d=r.bodyB;if(a=l?c.add(l.position,r.pointA):r.pointA,"pin"===r.render.type)o.beginPath(),o.arc(a.x,a.y,3,0,2*Math.PI),o.closePath();else{if(s=d?c.add(d.position,r.pointB):r.pointB,o.beginPath(),o.moveTo(a.x,a.y),"spring"===r.render.type)for(var u,h=c.sub(s,a),f=c.perp(c.normalise(h)),p=Math.ceil(i.clamp(r.length/5,12,20)),v=1;v<p;v+=1)u=v%2==0?1:-1,o.lineTo(a.x+h.x*(v/p)+f.x*u*4,a.y+h.y*(v/p)+f.y*u*4);o.lineTo(s.x,s.y)}r.render.lineWidth&&(o.lineWidth=r.render.lineWidth,o.strokeStyle=r.render.strokeStyle,o.stroke()),r.render.anchors&&(o.fillStyle=r.render.strokeStyle,o.beginPath(),o.arc(a.x,a.y,3,0,2*Math.PI),o.arc(s.x,s.y,3,0,2*Math.PI),o.closePath(),o.fill())}}},n.bodies=function(e,t,o){var n,r,i,a,s=o,l=(e.engine,e.options),c=l.showInternalEdges||!l.wireframes;for(i=0;i<t.length;i++)if((n=t[i]).render.visible)for(a=n.parts.length>1?1:0;a<n.parts.length;a++)if((r=n.parts[a]).render.visible){if(l.showSleeping&&n.isSleeping?s.globalAlpha=.5*r.render.opacity:1!==r.render.opacity&&(s.globalAlpha=r.render.opacity),r.render.sprite&&r.render.sprite.texture&&!l.wireframes){var d=r.render.sprite,u=p(e,d.texture);s.translate(r.position.x,r.position.y),s.rotate(r.angle),s.drawImage(u,u.width*-d.xOffset*d.xScale,u.height*-d.yOffset*d.yScale,u.width*d.xScale,u.height*d.yScale),s.rotate(-r.angle),s.translate(-r.position.x,-r.position.y)}else{if(r.circleRadius)s.beginPath(),s.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI);else{s.beginPath(),s.moveTo(r.vertices[0].x,r.vertices[0].y);for(var h=1;h<r.vertices.length;h++)!r.vertices[h-1].isInternal||c?s.lineTo(r.vertices[h].x,r.vertices[h].y):s.moveTo(r.vertices[h].x,r.vertices[h].y),r.vertices[h].isInternal&&!c&&s.moveTo(r.vertices[(h+1)%r.vertices.length].x,r.vertices[(h+1)%r.vertices.length].y);s.lineTo(r.vertices[0].x,r.vertices[0].y),s.closePath()}l.wireframes?(s.lineWidth=1,s.strokeStyle="#bbb",s.stroke()):(s.fillStyle=r.render.fillStyle,r.render.lineWidth&&(s.lineWidth=r.render.lineWidth,s.strokeStyle=r.render.strokeStyle,s.stroke()),s.fill())}s.globalAlpha=1}},n.bodyWireframes=function(e,t,o){var n,r,i,a,s,l=o,c=e.options.showInternalEdges;for(l.beginPath(),i=0;i<t.length;i++)if((n=t[i]).render.visible)for(s=n.parts.length>1?1:0;s<n.parts.length;s++){for(r=n.parts[s],l.moveTo(r.vertices[0].x,r.vertices[0].y),a=1;a<r.vertices.length;a++)!r.vertices[a-1].isInternal||c?l.lineTo(r.vertices[a].x,r.vertices[a].y):l.moveTo(r.vertices[a].x,r.vertices[a].y),r.vertices[a].isInternal&&!c&&l.moveTo(r.vertices[(a+1)%r.vertices.length].x,r.vertices[(a+1)%r.vertices.length].y);l.lineTo(r.vertices[0].x,r.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},n.bodyConvexHulls=function(e,t,o){var n,r,i,a=o;for(a.beginPath(),r=0;r<t.length;r++)if((n=t[r]).render.visible&&1!==n.parts.length){for(a.moveTo(n.vertices[0].x,n.vertices[0].y),i=1;i<n.vertices.length;i++)a.lineTo(n.vertices[i].x,n.vertices[i].y);a.lineTo(n.vertices[0].x,n.vertices[0].y)}a.lineWidth=1,a.strokeStyle="rgba(255,255,255,0.2)",a.stroke()},n.vertexNumbers=function(e,t,o){var n,r,i,a=o;for(n=0;n<t.length;n++){var s=t[n].parts;for(i=s.length>1?1:0;i<s.length;i++){var l=s[i];for(r=0;r<l.vertices.length;r++)a.fillStyle="rgba(255,255,255,0.2)",a.fillText(n+"_"+r,l.position.x+.8*(l.vertices[r].x-l.position.x),l.position.y+.8*(l.vertices[r].y-l.position.y))}}},n.mousePosition=function(e,t,o){var n=o;n.fillStyle="rgba(255,255,255,0.8)",n.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},n.bodyBounds=function(e,t,o){var n=o,r=(e.engine,e.options);n.beginPath();for(var i=0;i<t.length;i++)if(t[i].render.visible)for(var a=t[i].parts,s=a.length>1?1:0;s<a.length;s++){var l=a[s];n.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}r.wireframes?n.strokeStyle="rgba(255,255,255,0.08)":n.strokeStyle="rgba(0,0,0,0.1)",n.lineWidth=1,n.stroke()},n.bodyAxes=function(e,t,o){var n,r,i,a,s=o,l=(e.engine,e.options);for(s.beginPath(),r=0;r<t.length;r++){var c=t[r],d=c.parts;if(c.render.visible)if(l.showAxes)for(i=d.length>1?1:0;i<d.length;i++)for(n=d[i],a=0;a<n.axes.length;a++){var u=n.axes[a];s.moveTo(n.position.x,n.position.y),s.lineTo(n.position.x+20*u.x,n.position.y+20*u.y)}else for(i=d.length>1?1:0;i<d.length;i++)for(n=d[i],a=0;a<n.axes.length;a++)s.moveTo(n.position.x,n.position.y),s.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2)}l.wireframes?(s.strokeStyle="indianred",s.lineWidth=1):(s.strokeStyle="rgba(255, 255, 255, 0.4)",s.globalCompositeOperation="overlay",s.lineWidth=2),s.stroke(),s.globalCompositeOperation="source-over"},n.bodyPositions=function(e,t,o){var n,r,i,a,s=o,l=(e.engine,e.options);for(s.beginPath(),i=0;i<t.length;i++)if((n=t[i]).render.visible)for(a=0;a<n.parts.length;a++)r=n.parts[a],s.arc(r.position.x,r.position.y,3,0,2*Math.PI,!1),s.closePath();for(l.wireframes?s.fillStyle="indianred":s.fillStyle="rgba(0,0,0,0.5)",s.fill(),s.beginPath(),i=0;i<t.length;i++)(n=t[i]).render.visible&&(s.arc(n.positionPrev.x,n.positionPrev.y,2,0,2*Math.PI,!1),s.closePath());s.fillStyle="rgba(255,165,0,0.8)",s.fill()},n.bodyVelocity=function(e,t,o){var n=o;n.beginPath();for(var i=0;i<t.length;i++){var a=t[i];if(a.render.visible){var s=r.getVelocity(a);n.moveTo(a.position.x,a.position.y),n.lineTo(a.position.x+s.x,a.position.y+s.y)}}n.lineWidth=3,n.strokeStyle="cornflowerblue",n.stroke()},n.bodyIds=function(e,t,o){var n,r,i=o;for(n=0;n<t.length;n++)if(t[n].render.visible){var a=t[n].parts;for(r=a.length>1?1:0;r<a.length;r++){var s=a[r];i.font="12px Arial",i.fillStyle="rgba(255,255,255,0.5)",i.fillText(s.id,s.position.x+10,s.position.y-10)}}},n.collisions=function(e,t,o){var n,r,i,a,s=o,l=e.options;for(s.beginPath(),i=0;i<t.length;i++)if((n=t[i]).isActive)for(r=n.collision,a=0;a<n.activeContacts.length;a++){var c=n.activeContacts[a].vertex;s.rect(c.x-1.5,c.y-1.5,3.5,3.5)}for(l.wireframes?s.fillStyle="rgba(255,255,255,0.7)":s.fillStyle="orange",s.fill(),s.beginPath(),i=0;i<t.length;i++)if((n=t[i]).isActive&&(r=n.collision,n.activeContacts.length>0)){var d=n.activeContacts[0].vertex.x,u=n.activeContacts[0].vertex.y;2===n.activeContacts.length&&(d=(n.activeContacts[0].vertex.x+n.activeContacts[1].vertex.x)/2,u=(n.activeContacts[0].vertex.y+n.activeContacts[1].vertex.y)/2),r.bodyB===r.supports[0].body||!0===r.bodyA.isStatic?s.moveTo(d-8*r.normal.x,u-8*r.normal.y):s.moveTo(d+8*r.normal.x,u+8*r.normal.y),s.lineTo(d,u)}l.wireframes?s.strokeStyle="rgba(255,165,0,0.7)":s.strokeStyle="orange",s.lineWidth=1,s.stroke()},n.separations=function(e,t,o){var n,r,i,a,s,l=o,c=e.options;for(l.beginPath(),s=0;s<t.length;s++)if((n=t[s]).isActive){i=(r=n.collision).bodyA;var d=1;(a=r.bodyB).isStatic||i.isStatic||(d=.5),a.isStatic&&(d=0),l.moveTo(a.position.x,a.position.y),l.lineTo(a.position.x-r.penetration.x*d,a.position.y-r.penetration.y*d),d=1,a.isStatic||i.isStatic||(d=.5),i.isStatic&&(d=0),l.moveTo(i.position.x,i.position.y),l.lineTo(i.position.x+r.penetration.x*d,i.position.y+r.penetration.y*d)}c.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},n.inspector=function(e,t){e.engine;var o,n=e.selected,r=e.render,i=r.options;if(i.hasBounds){var a=r.bounds.max.x-r.bounds.min.x,s=r.bounds.max.y-r.bounds.min.y,l=a/r.options.width,c=s/r.options.height;t.scale(1/l,1/c),t.translate(-r.bounds.min.x,-r.bounds.min.y)}for(var d=0;d<n.length;d++){var u=n[d].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),u.type){case"body":o=u.bounds,t.beginPath(),t.rect(Math.floor(o.min.x-3),Math.floor(o.min.y-3),Math.floor(o.max.x-o.min.x+6),Math.floor(o.max.y-o.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var h=u.pointA;u.bodyA&&(h=u.pointB),t.beginPath(),t.arc(h.x,h.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",o=e.selectBounds,t.beginPath(),t.rect(Math.floor(o.min.x),Math.floor(o.min.y),Math.floor(o.max.x-o.min.x),Math.floor(o.max.y-o.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),i.hasBounds&&t.setTransform(1,0,0,1,0,0)};var o=function(e,t){var o=e.engine,r=e.timing,i=r.historySize,a=o.timing.timestamp;r.delta=t-r.lastTime||n._goodDelta,r.lastTime=t,r.timestampElapsed=a-r.lastTimestamp||0,r.lastTimestamp=a,r.deltaHistory.unshift(r.delta),r.deltaHistory.length=Math.min(r.deltaHistory.length,i),r.engineDeltaHistory.unshift(o.timing.lastDelta),r.engineDeltaHistory.length=Math.min(r.engineDeltaHistory.length,i),r.timestampElapsedHistory.unshift(r.timestampElapsed),r.timestampElapsedHistory.length=Math.min(r.timestampElapsedHistory.length,i),r.engineElapsedHistory.unshift(o.timing.lastElapsed),r.engineElapsedHistory.length=Math.min(r.engineElapsedHistory.length,i),r.elapsedHistory.unshift(r.lastElapsed),r.elapsedHistory.length=Math.min(r.elapsedHistory.length,i)},u=function(e){for(var t=0,o=0;o<e.length;o+=1)t+=e[o];return t/e.length||0},h=function(e,t){var o=document.createElement("canvas");return o.width=e,o.height=t,o.oncontextmenu=function(){return!1},o.onselectstart=function(){return!1},o},f=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},p=function(e,t){var o=e.textures[t];return o||((o=e.textures[t]=new Image).src=t,o)},v=function(e,t){var o=t;/(jpg|gif|png)$/.test(t)&&(o="url("+t+")"),e.canvas.style.background=o,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},function(e,t,o){var n={};e.exports=n;var r,i,a,s=o(5),l=o(17),c=o(0);"undefined"!=typeof window&&(r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,i=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r||(r=function(e){a=setTimeout((function(){e(c.now())}),1e3/60)},i=function(){clearTimeout(a)}),n.create=function(e){var t=c.extend({fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},n.run=function(e,t){return void 0!==e.positionIterations&&(t=e,e=n.create()),function o(i){e.frameRequestId=r(o),i&&e.enabled&&n.tick(e,t,i)}(),e},n.tick=function(e,t,o){var n,r=t.timing;e.isFixed?n=e.delta:(n=o-e.timePrev||e.delta,e.timePrev=o,e.deltaHistory.push(n),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),n=(n=(n=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:n)>e.deltaMax?e.deltaMax:n,e.delta=n);var i={timestamp:r.timestamp};s.trigger(e,"beforeTick",i),e.frameCounter+=1,o-e.counterTimestamp>=1e3&&(e.fps=e.frameCounter*((o-e.counterTimestamp)/1e3),e.counterTimestamp=o,e.frameCounter=0),s.trigger(e,"tick",i),s.trigger(e,"beforeUpdate",i),l.update(t,n),s.trigger(e,"afterUpdate",i),s.trigger(e,"afterTick",i)},n.stop=function(e){i(e.frameRequestId)},n.start=function(e,t){n.run(e,t)}},function(e,t,o){var n={};e.exports=n;var r=o(8),i=o(0).deprecated;n.collides=function(e,t){return r.collides(e,t)},i(n,"collides","SAT.collides ➤ replaced by Collision.collides")},function(e,t,o){var n={};e.exports=n,o(1);var r=o(0);n.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||r.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var o,i,a,s,l,c,d,u,h,f,p,v=[],y=0,g=0,m=0;t=t||15;var x=function(e,t,o){var n=o%2==1&&o>1;if(!h||e!=h.x||t!=h.y){h&&n?(f=h.x,p=h.y):(f=0,p=0);var r={x:f+e,y:p+t};!n&&h||(h=r),v.push(r),g=f+e,m=p+t}},b=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":g=e.x,m=e.y;break;case"H":g=e.x;break;case"V":m=e.y}x(g,m,e.pathSegType)}};for(n._svgPathToAbsolute(e),a=e.getTotalLength(),c=[],o=0;o<e.pathSegList.numberOfItems;o+=1)c.push(e.pathSegList.getItem(o));for(d=c.concat();y<a;){if((l=c[e.getPathSegAtLength(y)])!=u){for(;d.length&&d[0]!=l;)b(d.shift());u=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":s=e.getPointAtLength(y),x(s.x,s.y,0)}y+=t}for(o=0,i=d.length;o<i;++o)b(d[o]);return v},n._svgPathToAbsolute=function(e){for(var t,o,n,r,i,a,s=e.pathSegList,l=0,c=0,d=s.numberOfItems,u=0;u<d;++u){var h=s.getItem(u),f=h.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(f))"x"in h&&(l=h.x),"y"in h&&(c=h.y);else switch("x1"in h&&(n=l+h.x1),"x2"in h&&(i=l+h.x2),"y1"in h&&(r=c+h.y1),"y2"in h&&(a=c+h.y2),"x"in h&&(l+=h.x),"y"in h&&(c+=h.y),f){case"m":s.replaceItem(e.createSVGPathSegMovetoAbs(l,c),u);break;case"l":s.replaceItem(e.createSVGPathSegLinetoAbs(l,c),u);break;case"h":s.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":s.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),u);break;case"c":s.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,n,r,i,a),u);break;case"s":s.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,i,a),u);break;case"q":s.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,n,r),u);break;case"t":s.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),u);break;case"a":s.replaceItem(e.createSVGPathSegArcAbs(l,c,h.r1,h.r2,h.angle,h.largeArcFlag,h.sweepFlag),u);break;case"z":case"Z":l=t,c=o}"M"!=f&&"m"!=f||(t=l,o=c)}}},function(e,t,o){var n={};e.exports=n;var r=o(6);o(0),n.create=r.create,n.add=r.add,n.remove=r.remove,n.clear=r.clear,n.addComposite=r.addComposite,n.addBody=r.addBody,n.addConstraint=r.addConstraint}])},e.exports=n()},56:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},72:e=>{"use strict";var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var i={},a=[],s=0;s<e.length;s++){var l=e[s],c=n.base?l[0]+n.base:l[0],d=i[c]||0,u="".concat(c," ").concat(d);i[c]=d+1;var h=o(u),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(f);else{var p=r(f,n);n.byIndex=s,t.splice(s,0,{identifier:u,updater:p,references:1})}a.push(u)}return a}function r(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,r){var i=n(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=o(i[a]);t[s].references--}for(var l=n(e,r),c=0;c<i.length;c++){var d=o(i[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}i=l}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);n&&a[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),o&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=o):d[2]=o),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},365:(e,t,o)=>{"use strict";o.d(t,{A:()=>p});var n=o(601),r=o.n(n),i=o(314),a=o.n(i),s=o(417),l=o.n(s),c=new URL(o(990),o.b),d=new URL(o(411),o.b),u=a()(r());u.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=VT323&display=swap);"]);var h=l()(c),f=l()(d);u.push([e.id,`* {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n    image-rendering: pixelated;\n}\n\nbody {\n    font-family: 'VT323', monospace;\n    overflow: hidden;\n    background-color: #003366;\n    color: #FFCC33;\n    background-image: url(${h});\n    background-repeat: repeat;\n    cursor: url(${f}), auto;\n}\n\n#gameCanvas {\n    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);\n    border: 4px solid #663300;\n    border-radius: 0;\n    image-rendering: pixelated;\n    margin: 20px auto;\n    display: block;\n}\n\n/* Add early 2000s UI elements */\n.game-container {\n    position: relative;\n    margin: 0 auto;\n    width: 800px;\n}\n\n.game-title {\n    font-family: 'VT323', monospace;\n    text-align: center;\n    color: #FFCC33;\n    text-shadow: 2px 2px 0 #000000;\n    font-size: 40px;\n    margin-bottom: 10px;\n}\n\n.instruction {\n    font-family: 'VT323', monospace;\n    text-align: center;\n    color: #FFFFFF;\n    font-size: 16px;\n    margin-bottom: 10px;\n    background-color: #000000;\n    border: 2px solid #FFCC33;\n    padding: 5px;\n    width: 70%;\n    margin: 10px auto;\n} `,""]);const p=u},411:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAD6ADAAQAAAABAAAADwAAAACJocYTAAAA+UlEQVQoFY2SQY7DIAxFX6hCSDkBlSqNOlv13Lkxk8wmdFUuEJZppWZLaMy3/TFRVf3w+/H5JjMREfidnZuZKSLCzCmlmFIiIjIz7XU6Zyt1hV03OWd2CZgd+/FxKC+Mx+OB3ntfrffdOefhnHPOGftaKxHRqj23/WyXaQn0XotZL0Z/m8EmFkxrrarqW11oGLDGGOsXjWnmvQcRUUqJU0pqrTH51tq4Z0dKiXPObOb5V3QIxGdQC/gDiFLQ8Yv4AVAKOs7Ym3GpCg4Mb8ZaE7wfgXFVfVVRvWrGMSfDONoxtzZe7Prt+Dt57/jM7S81W/zP+vu85g8IfXgBk5nBnwAAAABJRU5ErkJggg=="},417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{"use strict";e.exports=function(e){return e[1]}},659:e=>{"use strict";var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n="";o.supports&&(n+="@supports (".concat(o.supports,") {")),o.media&&(n+="@media ".concat(o.media," {"));var r=void 0!==o.layer;r&&(n+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),n+=o.css,r&&(n+="}"),o.media&&(n+="}"),o.supports&&(n+="}");var i=o.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},990:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAEklEQVQImWNgYGD4z0AswK4SAFXuAf8EPy+xAAAAAElFTkSuQmCC"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={id:n,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.b=document.baseURI||self.location.href,o.nc=void 0,(()=>{"use strict";var e=o(46),t=o.n(e);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i,a,s=[],l=!0,c=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;l=!1}else for(;!(l=(n=i.call(o)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){s(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t,o){return(t=f(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=d(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==o.return||o.return()}finally{if(s)throw i}}}}function d(e,t){if(e){if("string"==typeof e)return u(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}function h(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var p=function(){return e=function e(t,o,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pegRadius=t,this.canvasWidth=o,this.canvasHeight=n,this.minPegSpacing=50,this.maxPatterns=4,this.colorProgression=[{level:1,colors:4},{level:3,colors:6},{level:11,colors:8}],this.patterns={grid:this.createGridPattern.bind(this),checkerboard:this.createCheckerboardPattern.bind(this),diamond:this.createDiamondPattern.bind(this),spiral:this.createSpiralPattern.bind(this),tunnel:this.createTunnelPattern.bind(this),wave:this.createWavePattern.bind(this),vortex:this.createVortexPattern.bind(this),concentric:this.createConcentricPattern.bind(this),zigzag:this.createZigzagPattern.bind(this),hourglass:this.createHourglassPattern.bind(this),maze:this.createMazePattern.bind(this),random:this.createRandomPattern.bind(this),clustered:this.createClusteredPattern.bind(this)},this.patternDifficulty={grid:1,checkerboard:2,random:3,diamond:4,wave:5,clustered:6,tunnel:7,spiral:8,vortex:10,concentric:6,zigzag:7,hourglass:8,maze:9},this.horizontalMargin=100,this.basePegCount=40,this.minPegCountPerLevel=35,this.pegIncreasePerLevel=5,this.maxPegCount=120},t=[{key:"getAvailableColors",value:function(e){var t,o=4,n=c(this.colorProgression);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!(e>=r.level))break;o=r.colors}}catch(e){n.e(e)}finally{n.f()}return o}},{key:"getMinimumPegCount",value:function(e){var t=this.minPegCountPerLevel+(e-1)*this.pegIncreasePerLevel;return Math.min(t,this.maxPegCount)}},{key:"generateLevel",value:function(e){this.currentLevelNumber=e;var t,o=Math.min(10,Math.floor(e/2)+1),n=Math.max(this.minPegSpacing-1.8*e,2.3*this.pegRadius),r=Math.min(this.maxPatterns,1+Math.floor(e/2)),i=this.selectPatternsByDifficulty(o),a=this.getMinimumPegCount(e),s=this.getAvailableColors(e);return(t=1===e?this.generateSimpleLevel(e,n,i):2===e?this.generateIntermediateLevel(e,n,i):3===e?this.generateAdvancedLevel(e,n,i):this.generateProceduralLevel(e,r,i,n)).length<a&&(t=this.ensureMinimumPegs(t,a,n,e,s)),this.balanceColors(t,s,e)}},{key:"generateSimpleLevel",value:function(e,t,o){var n=this.canvasWidth/2,r=(this.canvasHeight,this.canvasWidth-2*this.horizontalMargin),i=Math.floor(r/t),a=n-i*t/2;return this.createGridPattern(a,180,i,6,t,.8)}},{key:"generateIntermediateLevel",value:function(e,t,o){var n=[],r=(this.canvasWidth,this.canvasHeight,this.canvasWidth,this.horizontalMargin,["grid","checkerboard","diamond"].filter((function(e){return o.includes(e)})));r.length<2&&r.push("random");var i=r[0],a=r[r.length>1?1:0],s=this.divideCanvasIntoSections(2),c=this.patterns[i],d=this.generatePatternInSection(c,s[0],t,e),u=this.patterns[a],h=this.generatePatternInSection(u,s[1],t,e);return n.push.apply(n,l(d).concat(l(h))),n}},{key:"generateAdvancedLevel",value:function(e,t,o){for(var n=this,r=(this.canvasWidth,this.canvasHeight,2+(Math.random()>.5?1:0)),i=o.filter((function(e){var t=n.patternDifficulty[e]||5;return t>=2&&t<=6})),a=i.length>=r?i:o,s=[],l=0;l<r;l++)if(a.length>0){var c=Math.floor(Math.random()*a.length);s.push(a[c]),a.splice(c,1)}return this.generateProceduralLevel(e,s.length,s,t)}},{key:"balanceColors",value:function(e,t,o){var n,r=Array(8).fill(0),i=c(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;s.colorIndex<t&&r[s.colorIndex]++}}catch(e){i.e(e)}finally{i.f()}var l=e.map((function(e){if(e.colorIndex>=t){for(var o=0,n=1;n<t;n++)r[n]<r[o]&&(o=n);return r[e.colorIndex]--,r[o]++,a(a({},e),{},{colorIndex:o})}return e})),d=l;return o>3&&(d=this.applyColorGradient(l,t,o)),this.ensureMinimumColorCounts(d,t,o)}},{key:"ensureMinimumColorCounts",value:function(e,t,o){var n,r=Math.max(3,Math.floor(5-.1*o)),i=3===o?2:0,s=Array(8).fill(0),d=c(e);try{for(d.s();!(n=d.n()).done;){var u=n.value;u.colorIndex>=t&&(u.colorIndex=u.colorIndex%t),s[u.colorIndex]++}}catch(e){d.e(e)}finally{d.f()}3===o&&console.log("Level 3 color counts before balancing:",s);var h,f=l(e),p=c(3===o?[5,0,1,2,3,4]:l(Array(t).keys()));try{for(p.s();!(h=p.n()).done;){var v=h.value;if(!(v>=t)){var y=5===v&&3===o?r+i:r;if(s[v]<y){var g=y-s[v];console.log("Level ".concat(o,": Color ").concat(v," needs ").concat(g," more pegs"));for(var m=[],x=0;x<t;x++)3===o&&5===x||x!==v&&s[x]>r+2&&m.push(x);if(m.length>0){for(var b=0,M=0;M<f.length&&b<g;M++){var S=f[M];m.includes(S.colorIndex)&&(f[M]=a(a({},S),{},{colorIndex:v}),s[S.colorIndex]--,s[v]++,b++)}if(b<g)for(var A=0;A<f.length&&b<g;A++){var P=f[A];if(P.colorIndex!==v){if(3===o&&5===P.colorIndex)continue;f[A]=a(a({},P),{},{colorIndex:v}),s[P.colorIndex]--,s[v]++,b++}}}else for(var w=0,C=0;C<f.length&&w<g;C++)if(f[C].colorIndex!==v){if(3===o&&5===f[C].colorIndex)continue;var k=f[C].colorIndex;f[C].colorIndex=v,s[k]--,s[v]++,w++}}}}}catch(e){p.e(e)}finally{p.f()}if(3===o){var I,F=Array(8).fill(0),T=c(f);try{for(T.s();!(I=T.n()).done;)F[I.value.colorIndex]++}catch(e){T.e(e)}finally{T.f()}console.log("Level 3 color counts after balancing:",F)}for(var B=0;B<f.length;B++)f[B].colorIndex>=t&&(f[B].colorIndex=f[B].colorIndex%t);return f}},{key:"applyColorGradient",value:function(e,t,o){var n=[this.horizontalGradient.bind(this),this.verticalGradient.bind(this),this.radialGradient.bind(this),this.stripeGradient.bind(this),this.noiseGradient.bind(this),this.spiralGradient.bind(this),this.patternGradient.bind(this)],r=Math.min(n.length,2+Math.floor(o/2)),i=(o+Math.floor(3*Math.random()))%r;if(o>6&&Math.random()<.4){var s=(i+1+Math.floor(Math.random()*(r-1)))%r;return this.blendColorGradients(e,n[i],n[s],t,o)}return e.map((function(e){return a(a({},e),{},{colorIndex:n[i](e,t,o)})}))}},{key:"blendColorGradients",value:function(e,t,o,n,r){var i=this,s=.4*Math.random()-.2+.5;return e.map((function(e){var l,c=t(e,n,r),d=o(e,n,r);switch(r%3){case 0:l=(Math.floor(e.x/50)+Math.floor(e.y/50))%2==0?c:d;break;case 1:l=Math.sqrt(Math.pow(e.x-i.canvasWidth/2,2)+Math.pow(e.y-i.canvasHeight/2,2))/Math.sqrt(Math.pow(i.canvasWidth/2,2)+Math.pow(i.canvasHeight/2,2))<s?c:d;break;case 2:l=Math.random()<s?c:d}return a(a({},e),{},{colorIndex:l})}))}},{key:"horizontalGradient",value:function(e,t,o){var n=(e.x-this.horizontalMargin)/(this.canvasWidth-2*this.horizontalMargin);return Math.floor(n*t)}},{key:"verticalGradient",value:function(e,t,o){var n=e.y/this.canvasHeight;return Math.floor(n*t)}},{key:"radialGradient",value:function(e,t,o){var n=this.canvasWidth/2,r=this.canvasHeight/2,i=e.x-n,a=e.y-r,s=Math.sqrt(i*i+a*a)/Math.sqrt(n*n+r*r);return Math.floor(s*t)}},{key:"stripeGradient",value:function(e,t,o){var n=40+o%3*15;return Math.floor(e.x/n)%t}},{key:"noiseGradient",value:function(e,t,o){var n=.01+.002*o,r=this.simpleNoise(e.x*n,e.y*n);return Math.floor(r*t)}},{key:"spiralGradient",value:function(e,t,o){var n=this.canvasWidth/2,r=this.canvasHeight/2,i=e.x-n,a=e.y-r,s=(Math.atan2(a,i)+.01*Math.sqrt(i*i+a*a)*o)/(2*Math.PI);return Math.floor(s%1*t)}},{key:"patternGradient",value:function(e,t,o){var n=100-2*o,r=Math.floor(e.x/n),i=Math.floor(e.y/n);return this.hashFunction(r,i,o)%t}},{key:"hashFunction",value:function(e,t,o){return Math.abs((3733*e+2053*t^4057*o)%967)}},{key:"simpleNoise",value:function(e,t){var o=43758.5453*Math.sin(12.9898*e+78.233*t);return o-Math.floor(o)}},{key:"ensureMinimumPegs",value:function(e,t,o,n,r){if(console.log("Level ".concat(n,": Adding more pegs to reach minimum count (").concat(e.length,"/").concat(t,")")),e.length>=t)return e;this.canvasWidth,this.horizontalMargin;var i=this.canvasHeight-80,a=t-e.length,s=l(e),c=this.createFillerPegs(this.horizontalMargin,120,this.canvasWidth-this.horizontalMargin,i,1.2*o,a,s,r);s.push.apply(s,l(c));var d=this.removePegOverlaps(s,.8*o);if((d=this.removeEdgePegs(d,2*this.pegRadius)).length<t&&o>3*this.pegRadius){var u=.9*o;return this.ensureMinimumPegs(d,t,u,n,r)}return d}},{key:"createFillerPegs",value:function(e,t,o,n,r,i,a,s){for(var l=[],d=0,u=20*i;l.length<i&&d<u;){d++;var h,f=e+Math.random()*(o-e),p=t+Math.random()*(n-t),v=!1,y=c(a);try{for(y.s();!(h=y.n()).done;){var g=h.value,m=g.x-f,x=g.y-p;if(Math.sqrt(m*m+x*x)<r){v=!0;break}}}catch(e){y.e(e)}finally{y.f()}if(!v){var b,M=c(l);try{for(M.s();!(b=M.n()).done;){var S=b.value,A=S.x-f,P=S.y-p;if(Math.sqrt(A*A+P*P)<r){v=!0;break}}}catch(e){M.e(e)}finally{M.f()}}if(!v){var w,C=Array(8).fill(0),k=c(a);try{for(k.s();!(w=k.n()).done;){var I=w.value;I.colorIndex<s&&C[I.colorIndex]++}}catch(e){k.e(e)}finally{k.f()}var F,T=c(l);try{for(T.s();!(F=T.n()).done;){var B=F.value;B.colorIndex<s&&C[B.colorIndex]++}}catch(e){T.e(e)}finally{T.f()}for(var R=0,_=1;_<s;_++)C[_]<C[R]&&(R=_);var L=Math.random()<.7?R:Math.floor(Math.random()*s);l.push({x:f,y:p,colorIndex:L})}}return l}},{key:"generateProceduralLevel",value:function(e,t,o,n){var r,i=[];r=e>7?this.createOverlappingSections(t,e):this.divideCanvasIntoSections(t);for(var a=this.selectRandomPatternsForLevel(o,t,e),s=0;s<t;s++){var c=r[s],d=a[s],u=this.patterns[d],h=this.generatePatternInSection(u,c,n,e),f=this.applyProceduralNoise(h,e,n);i.push.apply(i,l(f))}var p=10+5*Math.floor(e/2),v=this.createRandomPattern(this.horizontalMargin,150,this.canvasWidth-this.horizontalMargin,this.canvasHeight-150,1.5*n,p);if(i.push.apply(i,l(v)),e>5){var y=this.createChallengeCluster(e,.8*n);i.push.apply(i,l(y))}var g=this.removePegOverlaps(i,.8*n);return this.removeEdgePegs(g,2*this.pegRadius)}},{key:"applyProceduralNoise",value:function(e,t,o){if(t<=2)return e;var n=Math.min(.3,.05+.02*t),r=Math.min(.3,.05+.01*t),i=o*n;return e.filter((function(){return Math.random()>r})).map((function(e){var t=(2*Math.random()-1)*i,o=(2*Math.random()-1)*i;return{x:e.x+t,y:e.y+o,colorIndex:e.colorIndex}}))}},{key:"createChallengeCluster",value:function(e,t){var o=[],n=this.getAvailableColors(e),r=150+Math.random()*(this.canvasWidth-300),i=150+Math.random()*(this.canvasHeight-300);switch(e%4){case 0:for(var a=5+Math.floor(e/3),s=2*t,l=0;l<a;l++){var c=l/a*Math.PI*2,d=s*Math.random();o.push({x:r+Math.cos(c)*d,y:i+Math.sin(c)*d,colorIndex:l%n})}break;case 1:for(var u=5+Math.floor(e/3),h=Math.random()*Math.PI,f=0;f<u;f++)o.push({x:r+Math.cos(h)*f*t*.8,y:i+Math.sin(h)*f*t*.8,colorIndex:f%n});break;case 2:for(var p=2+Math.floor(e/4),v=0;v<p;v++)for(var y=0;y<p;y++)o.push({x:r+(y-p/2)*t*.8,y:i+(v-p/2)*t*.8,colorIndex:(v+y)%n});break;case 3:for(var g=2+Math.floor(e/5),m=3+Math.floor(e/4),x=0;x<g;x++)for(var b=x*Math.PI*2/g,M=0;M<m;M++){var S=M*t*.7,A=b+.4*M;o.push({x:r+Math.cos(A)*S,y:i+Math.sin(A)*S,colorIndex:(x+M)%n})}}return o}},{key:"createOverlappingSections",value:function(e,t){var o=[],n=this.canvasHeight-80-120,r=this.canvasWidth-2*this.horizontalMargin,i=this.horizontalMargin,a=this.divideCanvasIntoSections(e);o.push.apply(o,l(a));for(var s=Math.min(3,Math.floor(t/4)),c=0;c<s;c++){var d=r*(.3+.4*Math.random()),u=n*(.3+.4*Math.random()),h=i+Math.random()*(r-d),f=120+Math.random()*(n-u);o.push({x:h,y:f,width:d,height:u})}return o}},{key:"selectRandomPatternsForLevel",value:function(e,t,o){var n,r=[],i=c(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=this.patternDifficulty[a]||5,l=Math.min(1,o/10);l=o<=5?10-s:s;for(var d=0;d<l;d++)r.push(a)}}catch(e){i.e(e)}finally{i.f()}for(var u=[],h=0;h<t&&0!==r.length;h++){var f=r[Math.floor(Math.random()*r.length)];if(u.push(f),u.length<t-1)for(var p=r.length-1;p>=0;p--)r[p]===f&&r.splice(p,1)}return u}},{key:"removePegOverlaps",value:function(e,t){var o,n=[],r=c(e);try{for(r.s();!(o=r.n()).done;){var i,a=o.value,s=!1,l=c(n);try{for(l.s();!(i=l.n()).done;){var d=i.value,u=d.x-a.x,h=d.y-a.y;if(Math.sqrt(u*u+h*h)<t){s=!0;break}}}catch(e){l.e(e)}finally{l.f()}s||n.push(a)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"removeEdgePegs",value:function(e,t){var o=this;return e.filter((function(e){return e.x>=o.horizontalMargin+t&&e.x<=o.canvasWidth-o.horizontalMargin-t&&e.y>=t&&e.y<=o.canvasHeight-t}))}},{key:"divideCanvasIntoSections",value:function(e){var t=this,o=[],n=120,r=this.canvasHeight-80,i=r-n,s=this.canvasWidth-2*this.horizontalMargin,l=this.horizontalMargin,c=.1*s,d=.1*i;if(1===e)o.push({x:l,y:n,width:s,height:i});else if(2===e)if(Math.random()>.5){var u=n+i/2+(Math.random()*d*2-d),h=30+20*Math.random();o.push({x:l,y:n,width:s,height:u-n-h/2}),o.push({x:l,y:u+h/2,width:s,height:r-u-h/2})}else{var f=l+s/2+(Math.random()*c*2-c),p=30+20*Math.random();o.push({x:l,y:n,width:f-l-p/2,height:i}),o.push({x:f+p/2,y:n,width:l+s-f-p/2,height:i})}else switch(Math.floor(3*Math.random())){case 0:for(var v=Math.ceil(Math.sqrt(e)),y=Math.ceil(e/v),g=s/y,m=i/v,x=0;x<e;x++){var b=Math.floor(x/y),M=x%y,S=.5*(Math.random()*c*2-c),A=.5*(Math.random()*d*2-d),P=Math.min(.2*g,Math.random()*g*.4-.2*g),w=Math.min(.2*m,Math.random()*m*.4-.2*m);o.push({x:l+M*g+S,y:n+b*m+A,width:.9*g+P,height:.9*m+w})}break;case 1:for(var C=s,k=l,I=0;I<e;I++){var F=I===e-1,T=F?C:C/(e-I),B=F?0:.3*T,R=T+(Math.random()*B*2-B);o.push({x:k,y:n,width:R,height:i}),k+=R,C-=R}break;case 2:var _={x:l,y:n,width:s,height:i};for(o.push(_);o.length<e;){for(var L=0,E=0,V=0;V<o.length;V++){var D=o[V].width*o[V].height;D>E&&(E=D,L=V)}var O=o[L];if(O.width>O.height){var z=O.width*(.3+.4*Math.random()),W={x:O.x,y:O.y,width:z-10,height:O.height},G={x:O.x+z+10,y:O.y,width:O.width-z-10,height:O.height};o.splice(L,1,W,G)}else{var q=O.height*(.3+.4*Math.random()),j={x:O.x,y:O.y,width:O.width,height:q-10},H={x:O.x,y:O.y+q+10,width:O.width,height:O.height-q-10};o.splice(L,1,j,H)}}for(;o.length>e;){for(var N=0,U=1/0,Q=0;Q<o.length;Q++){var X=o[Q].width*o[Q].height;X<U&&(U=X,N=Q)}o.splice(N,1)}}return o.map((function(e){if(t.currentLevelNumber>5&&e.width<.6*s&&e.height<.6*i&&Math.random()<.3){var o=(30*Math.random()-15)*Math.PI/180;return a(a({},e),{},{rotation:o})}return e}))}},{key:"generatePatternInSection",value:function(e,t,o,n){var r=t.x+t.width/2,i=t.y+t.height/2,a=void 0!==t.rotation,s=[];if(e===this.createGridPattern||e===this.createCheckerboardPattern){var l=Math.floor(t.width/o),c=Math.floor(t.height/o);s=e(r-l*o/2,i-c*o/2,l,c,o,.5)}else if(e===this.createDiamondPattern){var d=.45*Math.min(t.width,t.height);s=e(r,i,d,o)}else if(e===this.createSpiralPattern||e===this.createVortexPattern){var u=.45*Math.min(t.width,t.height);s=e(r,i,u,2+n%3,o)}else if(e===this.createWavePattern)s=e(t.x,t.y,t.width,t.height,o,2+n%3);else if(e===this.createTunnelPattern)s=e(r,i,.45*Math.min(t.width,t.height),o,n%2==0);else if(e===this.createRandomPattern){var h=Math.floor(t.width*t.height/(o*o)*.3);s=e(t.x+2*this.pegRadius,t.y+2*this.pegRadius,t.x+t.width-2*this.pegRadius,t.y+t.height-2*this.pegRadius,o,h)}else if(e===this.createClusteredPattern){var f=1+Math.floor(n/5);s=e(t.x,t.y,t.width,t.height,o,f)}else if(e===this.createConcentricPattern){var p=.45*Math.min(t.width,t.height);s=e(r,i,p,o)}else if(e===this.createZigzagPattern){var v=t.width,y=t.height;s=e(t.x,t.y,v,y,o)}else if(e===this.createHourglassPattern){var g=.45*Math.min(t.width,t.height);s=e(r,i,g,o)}else if(e===this.createMazePattern){var m=t.width,x=t.height;s=e(t.x,t.y,m,x,o)}return a?s.map((function(e){var o=e.x-r,n=e.y-i,a=Math.cos(t.rotation),s=Math.sin(t.rotation);return{x:r+(o*a-n*s),y:i+(o*s+n*a),colorIndex:e.colorIndex}})):s}},{key:"selectPatternsByDifficulty",value:function(e){var t=this;return Object.keys(this.patterns).filter((function(o){return(t.patternDifficulty[o]||5)<=e+2}))}},{key:"createGridPattern",value:function(e,t,o,n,r){for(var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=[],s=this.getAvailableColors(this.currentLevelNumber||1),l=0;l<n;l++)for(var c=0;c<o;c++)if(!(Math.random()>i)){var d=e+c*r,u=t+l*r,h=Math.floor(Math.random()*s);a.push({x:d,y:u,colorIndex:h})}return a}},{key:"createCheckerboardPattern",value:function(e,t,o,n,r){for(var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=[],s=this.getAvailableColors(this.currentLevelNumber||1),l=0;l<n;l++)for(var c=0;c<o;c++)if((l+c)%2==0&&Math.random()<=i){var d=e+c*r,u=t+l*r,h=Math.floor(Math.random()*s);a.push({x:d,y:u,colorIndex:h})}return a}},{key:"createDiamondPattern",value:function(e,t,o,n){for(var r=[],i=Math.floor(o/n),a=this.getAvailableColors(this.currentLevelNumber||1),s=-i;s<=i;s++)for(var l=Math.floor(2*(i-Math.abs(s))),c=-l/2;c<=l/2;c++){var d=e+c*n,u=t+s*n,h=Math.floor(Math.random()*a);r.push({x:d,y:u,colorIndex:h})}return r}},{key:"createSpiralPattern",value:function(e,t,o){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,r=[],i=(arguments.length>4?arguments[4]:void 0)/o,a=this.getAvailableColors(this.currentLevelNumber||1),s=2*n*Math.PI,l=Math.floor(s/i),c=0;c<l;c++){var d=c*i,u=o*d/s;if(!(u>=o)){var h=e+Math.cos(d)*u,f=t+Math.sin(d)*u,p=Math.floor(Math.random()*a);r.push({x:h,y:f,colorIndex:p})}}return r}},{key:"createTunnelPattern",value:function(e,t,o,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=[],a=Math.floor(o/n),s=this.getAvailableColors(this.currentLevelNumber||1);if(r)for(var l=-a;l<=a;l++)i.push({x:e+l*n,y:t-3*n/2,colorIndex:Math.floor(Math.random()*s)}),i.push({x:e+l*n,y:t+3*n/2,colorIndex:Math.floor(Math.random()*s)});else for(var c=-a;c<=a;c++)i.push({x:e-3*n/2,y:t+c*n,colorIndex:Math.floor(Math.random()*s)}),i.push({x:e+3*n/2,y:t+c*n,colorIndex:Math.floor(Math.random()*s)});return i}},{key:"createWavePattern",value:function(e,t,o,n,r){for(var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,a=[],s=Math.floor(o/r),l=Math.floor(n/r),c=this.getAvailableColors(this.currentLevelNumber||1),d=l/3,u=Math.PI*i/s,h=0;h<s;h++){var f=Math.sin(h*u)*d,p=e+h*r,v=t+Math.round(l/2+f)*r,y=Math.floor(Math.random()*c);a.push({x:p,y:v,colorIndex:y}),a.push({x:p,y:v-r,colorIndex:Math.floor(Math.random()*c)}),a.push({x:p,y:v+r,colorIndex:Math.floor(Math.random()*c)})}return a}},{key:"createVortexPattern",value:function(e,t,o){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,r=[],i=(arguments.length>4?arguments[4]:void 0)/o,a=this.getAvailableColors(this.currentLevelNumber||1),s=2*n*Math.PI,l=Math.floor(s/i),c=0;c<3;c++)for(var d=2*c*Math.PI/3,u=0;u<l;u++){var h=u*i+d,f=o*h/s;if(!(f>=o)){var p=e+Math.cos(h)*f,v=t+Math.sin(h)*f,y=c%a;r.push({x:p,y:v,colorIndex:y})}}return r}},{key:"createRandomPattern",value:function(e,t,o,n,r,i){for(var a=[],s=this.getAvailableColors(this.currentLevelNumber||1),l=0,d=10*i;a.length<i&&l<d;){l++;var u,h=e+Math.random()*(o-e),f=t+Math.random()*(n-t),p=!1,v=c(a);try{for(v.s();!(u=v.n()).done;){var y=u.value,g=y.x-h,m=y.y-f;if(Math.sqrt(g*g+m*m)<r){p=!0;break}}}catch(e){v.e(e)}finally{v.f()}if(!p){var x=Math.floor(Math.random()*s);a.push({x:h,y:f,colorIndex:x})}}return a}},{key:"createClusteredPattern",value:function(e,t,o,n,r){for(var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,a=[],s=this.getAvailableColors(this.currentLevelNumber||1),l=[],c=0;c<i;c++)l.push({x:e+Math.random()*o,y:t+Math.random()*n,colorIndex:Math.floor(Math.random()*s)});for(var d=0,u=l;d<u.length;d++)for(var h=u[d],f=3*r,p=0;p<15;p++){var v=Math.random()*Math.PI*2,y=f*Math.pow(Math.random(),.5),g=h.x+Math.cos(v)*y,m=h.y+Math.sin(v)*y,x=Math.random()<.7?h.colorIndex:Math.floor(Math.random()*s);a.push({x:g,y:m,colorIndex:x})}return this.removePegOverlaps(a,.8*r)}},{key:"createConcentricPattern",value:function(e,t,o,n){for(var r=[],i=Math.floor(o/n),a=this.getAvailableColors(this.currentLevelNumber||1),s=1;s<=i;s++)for(var l=s*n,c=2*Math.PI*l,d=Math.floor(c/n),u=0;u<d;u++){var h=u/d*2*Math.PI,f=e+Math.cos(h)*l,p=t+Math.sin(h)*l,v=s%a;r.push({x:f,y:p,colorIndex:v})}return r}},{key:"createZigzagPattern",value:function(e,t,o,n,r){for(var i=[],a=Math.floor(o/r),s=3*r,l=this.getAvailableColors(this.currentLevelNumber||1),c=0;c<a;c++)for(var d=e+c*r,u=c%2==0?0:s/2,h=0;h*s<n;h++){var f=t+h*s+u,p=(c+h)%l;i.push({x:d,y:f,colorIndex:p})}return i}},{key:"createHourglassPattern",value:function(e,t,o,n){for(var r=[],i=Math.floor(o/n),a=this.getAvailableColors(this.currentLevelNumber||1),s=-i;s<=i;s++)for(var l=Math.abs(s)/i,c=Math.max(1,Math.floor(l*i)),d=-c;d<=c;d++){var u=e+d*n,h=t+s*n,f=(Math.abs(s)+Math.abs(d))%a;r.push({x:u,y:h,colorIndex:f})}return r}},{key:"createMazePattern",value:function(e,t,o,n,i){for(var a=[],s=Math.floor(o/i),l=Math.floor(n/i),c=this.getAvailableColors(this.currentLevelNumber||1),d=Array(l).fill().map((function(){return Array(s).fill(!1)})),u=0;u<l;u+=2)for(var h=0;h<s;h+=2){d[u][h]=!0;var f=[[u+1,h],[u,h+1]].filter((function(e){var t=r(e,2),o=t[0],n=t[1];return o<l&&n<s}));if(f.length>0&&Math.random()<.7){var p=r(f[Math.floor(Math.random()*f.length)],2),v=p[0],y=p[1];d[v][y]=!0}}for(var g=0;g<l;g++)for(var m=0;m<s;m++)if(d[g][m]){var x=e+m*i,b=t+g*i,M=(g+m)%c;a.push({x,y:b,colorIndex:M})}return a}},{key:"getColorThresholds",value:function(e){var t,o=this.getAvailableColors(e);t=e<=5?.25+(e-1)/4*.15:e<=10?.4+(e-6)/4*.15:e<=15?.55+(e-11)/4*.15:Math.min(.8,.7+(e-16)/10*.1);for(var n=Array(8).fill(0),r=0;r<o;r++){var i=0;e>3&&(0===r?i=.05:r===o-1&&(i=-.03),i+=.06*Math.random()-.03),n[r]=Math.min(.85,Math.max(.2,t+i))}return console.log("Level ".concat(e," thresholds:"),n.slice(0,o)),n}}],t&&h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const v=p;var y=o(72),g=o.n(y),m=o(825),x=o.n(m),b=o(659),M=o.n(b),S=o(56),A=o.n(S),P=o(540),w=o.n(P),C=o(113),k=o.n(C),I=o(365),F={};function T(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(e){if("string"==typeof e)return B(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==o.return||o.return()}finally{if(s)throw i}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}F.styleTagTransform=k(),F.setAttributes=A(),F.insert=M().bind(null,"head"),F.domAPI=x(),F.insertStyleElement=w(),g()(I.A,F),I.A&&I.A.locals&&I.A.locals;var R=t().Engine,_=t().Render,L=t().World,E=t().Bodies,V=t().Body,D=t().Events,O=t().Composite,z=(t().Common,t().Vector,t().Sleeping),W=800,G=650,q=10,j=10,H=400,N=40,U=W,Q=[],X=1,Z=0,Y=[["#001133","#002266","#0044AA"],["#330011","#660022","#AA0044"],["#002211","#004422","#008844"],["#221100","#442200","#884400"],["#110022","#220044","#440088"],["#331111","#662222","#AA4444"],["#113311","#226622","#44AA44"],["#221133","#442266","#6644AA"],["#222211","#443322","#665533"],["#111122","#222244","#3333AA"]],K=Y[0],$={horizontal:[],vertical:[]},J=!1,ee="",te=0,oe=0,ne={active:!1,startTime:0,duration:1e3,nextLevel:1},re=!1,ie=0,ae=10,se=100,le=0,ce=10,de=Math.PI/2,ue=[],he=1,fe=!1,pe=1,ve=2,ye=[.25,.25,.25,.25,.25,.25,.25,.25],ge=!1,me=new v(q,W,G),xe=R.create({enableSleeping:!0,constraintIterations:4,positionIterations:8,velocityIterations:8}),be=xe.world;be.gravity.y=.5;var Me=document.getElementById("gameCanvas");Me.width=980,Me.height=G;var Se=_.create({canvas:Me,engine:xe,options:{width:980,height:G,wireframes:!1,background:"#003366",transparent:!1}}),Ae=[E.rectangle(400,-30,W,60,{isStatic:!0,render:{fillStyle:"#663300"}}),E.rectangle(-30,325,60,G,{isStatic:!0,render:{fillStyle:"#663300"}}),E.rectangle(830,325,60,G,{isStatic:!0,render:{fillStyle:"#663300"}})],Pe=E.circle(H,N,30,{isStatic:!0,label:"launcher_base",render:{fillStyle:"#FF6600",strokeStyle:"#000000",lineWidth:3}});function we(e,t,o){var n=De(he);o>=n&&(o=Math.floor(Math.random()*n),console.log("Replacing out-of-range color index ".concat(o," with ").concat(o%n)));var r=E.circle(e,t,q,{isStatic:!0,label:"peg",render:{fillStyle:"transparent",strokeStyle:"transparent",lineWidth:0,opacity:0},originalColor:["#FF0000","#0000FF","#FFFF00","#00FF00","#FF00FF","#00FFFF","#FF8800","#8800FF"][o],colorGroup:o,isHit:!1,restitution:.8,friction:.001,frictionAir:0,slop:0,animationOffset:1e3*Math.random()});return r.render.visualComponent="peg",r}var Ce=[],ke=[0,0,0,0,0,0,0,0],Ie=[0,0,0,0,0,0,0,0],Fe=E.fromVertices(400,620,[[{x:-90,y:15},{x:-85,y:7},{x:-80,y:2.5},{x:-75,y:0},{x:-65,y:-4},{x:-60,y:-5},{x:-55,y:-20/3},{x:-50,y:-5},{x:-25,y:-10},{x:0,y:-12},{x:25,y:-10},{x:50,y:-5},{x:55,y:-20/3},{x:60,y:-5},{x:65,y:-4},{x:75,y:0},{x:80,y:2.5},{x:85,y:7},{x:90,y:15}]],{isStatic:!0,label:"bucket",restitution:1.4,friction:.001,render:{fillStyle:"#4488CC",strokeStyle:"#000000",lineWidth:2}});O.add(be,[].concat(Ae,[],[Fe,Pe])),_e(),Ve(he),Me.addEventListener("mousemove",(function(e){var t=Me.getBoundingClientRect(),o=e.clientX-t.left,n=e.clientY-t.top,r=o-H,i=n-N;(de=Math.atan2(i,r))<0?de=0:de>Math.PI&&(de=Math.PI)})),Me.addEventListener("mousedown",(function(e){var t=Me.getBoundingClientRect(),o=e.clientX-t.left,n=e.clientY-t.top;if(ge)return le=0,ie=0,ce=ae=10,he=1,fe=!1,ge=!1,re=!1,ne={active:!1,startTime:0,duration:1e3,nextLevel:1},void _e();if(re)return o>=225&&o<=575&&n>=255&&n<=315?void function(){if(ie>=100){var e=Math.min(1,10-ae);e<=0||(ie-=se*e,ae+=e,ce+=e)}}():o>=300&&o<=500&&n>=425&&n<=475?(re=!1,fe=!1,le=0,he++,void _e()):void 0;if(ce>0&&!fe){var r=E.circle(H,N,j,{restitution:.8,friction:.001,frictionAir:5e-4,label:"ball",collisionFilter:{category:2,mask:4294967295},render:{fillStyle:"transparent",strokeStyle:"transparent",lineWidth:0},spinAngle:0,spinSpeed:.05+.1*Math.random()}),i=H+50*Math.cos(de),a=N+50*Math.sin(de);V.setPosition(r,{x:i,y:a}),L.add(be,r);var s=.05*Math.cos(de)*100,l=.05*Math.sin(de)*100;V.setVelocity(r,{x:s,y:l}),ce--,ae--}})),D.on(xe,"collisionStart",(function(e){for(var t=e.pairs,o=0;o<t.length;o++){var n=t[o];if("ball"===n.bodyA.label&&"peg"===n.bodyB.label||"peg"===n.bodyA.label&&"ball"===n.bodyB.label){var r="peg"===n.bodyA.label?n.bodyA:n.bodyB;r.isHit||(r.isHit=!0,Ie[r.colorGroup]++,le+=10,r.render.fillStyle="#999999",ue.push({peg:r,hitTime:Date.now()}))}if("ball"===n.bodyA.label&&"bucket"===n.bodyB.label||"bucket"===n.bodyA.label&&"ball"===n.bodyB.label){le+=20;var i="ball"===n.bodyA.label?n.bodyA:n.bodyB,a="bucket"===n.bodyA.label?n.bodyA:n.bodyB,s=i.position,l=a.position,c=s.x-l.x,d=(s.y,l.y,i.velocity),u=1.3+Math.abs(c)/90*.7;V.setVelocity(i,{x:d.x*u,y:d.y*u}),Oe(s.x,s.y)}}}));var Te=1e3/60,Be=0,Re=0;function _e(){var e=O.allBodies(be),t=e.filter((function(e){return"peg"===e.label}));O.remove(be,t),ue=[];var o=e.filter((function(e){return"ball"===e.label}));O.remove(be,o),ke=[0,0,0,0,0,0,0,0],Ie=[0,0,0,0,0,0,0,0],ye=me.getColorThresholds(he),Ce.length=0;var n,r=T(me.generateLevel(he));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=we(i.x,i.y,i.colorIndex);Ce.push(a),ke[i.colorIndex]++}}catch(e){r.e(e)}finally{r.f()}O.add(be,Ce),fe=!1,ce=1===he?ae=10:ae,ve=Math.min(5,2+.3*he),Ve(he)}function Le(){if(!fe){for(var e=!0,t=0;t<8;t++)if((ke[t]>0?Ie[t]/ke[t]:1)<ye[t]){e=!1;break}e&&(fe=!0,ie+=le+=500+50*he,setTimeout((function(){re=!0}),2e3))}}function Ee(e,t,o,n,r,i){var a=Math.PI/2*3,s=t,l=o,c=Math.PI/n;e.beginPath(),e.moveTo(t,o-r);for(var d=0;d<n;d++)s=t+Math.cos(a)*r,l=o+Math.sin(a)*r,e.lineTo(s,l),a+=c,s=t+Math.cos(a)*i,l=o+Math.sin(a)*i,e.lineTo(s,l),a+=c;e.lineTo(t,o-r),e.closePath(),e.fill()}function Ve(e){X=Math.min(1.8,1+.15*(e-1));var t=Math.min(Y.length-1,Math.floor((e-1)/4));K=Y[t],Q=[];var o=Math.min(Math.floor(40*(1+.6*(X-1))),80),n=Math.max(25,40-.8*e);$={horizontal:[],vertical:[]};for(var r=0;r<W;r+=n)$.vertical.push(r);for(var i=0;i<G;i+=n)$.horizontal.push(i);te=Math.max(0,(e-6)/20),oe=Math.max(0,(e-10)/40);for(var a=0;a<o;a++){var s,l=e>5?Math.random()>.6?2:Math.random()>.5?1:0:Math.random()>.7?2:Math.random()>.5?1:0;s=e<=3?Math.floor(2*Math.random()):e<=7?Math.random()<.7?Math.floor(2*Math.random()):Math.floor(2*Math.random())+2:Math.random()<.5?Math.floor(2*Math.random())+2:Math.floor(2*Math.random());var c=1+e/20,d=1+e/12;Q.push({x:Math.random()*W,y:Math.random()*G,size:2+5*Math.random()*X,speed:(.2+.3*Math.random()*X)*c,direction:Math.random()*Math.PI*2,spin:.015*(Math.random()-.5)*X*d,opacity:.1+.3*Math.random(),color:K[l],shape:s,pulse:.2+.5*Math.random(),pulsePhase:Math.random()*Math.PI*2,erraticMovement:Math.random()*Math.min(.5,(e-4)/20),glitchChance:Math.min(.05,.004*(e-7))})}}function De(e){return e<=2?4:e>=3&&e<=10?6:e>=11?8:4}function Oe(e,t){var o=document.createElement("canvas");o.width=100,o.height=100,o.style.position="absolute",o.style.left=e-50+"px",o.style.top=t-50+"px",o.style.pointerEvents="none",o.style.zIndex="10",document.body.appendChild(o);var n=o.getContext("2d"),r=0,i=function(){n.clearRect(0,0,100,100);var e=1-r/10;if(e<=0)document.body.removeChild(o);else{n.beginPath(),n.arc(50,50,5*r,0,2*Math.PI),n.fillStyle="rgba(255, 255, 255, ".concat(.3*e,")"),n.fill();for(var t=0;t<8;t++){var a=t/8*Math.PI*2,s=3*r,l=50+Math.cos(a)*s,c=50+Math.sin(a)*s;n.beginPath(),n.arc(l,c,2,0,2*Math.PI),n.fillStyle="rgba(200, 230, 255, ".concat(e,")"),n.fill()}r++,requestAnimationFrame(i)}};i()}D.on(Se,"afterRender",(function(){var e=Se.context;!function(e){var t=Date.now()/1e3,o=0,n=0;oe>0&&(o=(Math.random()-.5)*oe*4,n=(Math.random()-.5)*oe*4,e.save(),e.translate(o,n));var r=.08+.02*(X-1),i=Math.sin(.15*t)*r,a=e.createRadialGradient(W*(.5+i),G*(.5-i),0,400,325,640);a.addColorStop(0,K[2]),a.addColorStop(.3,K[1]),a.addColorStop(1,K[0]),e.fillStyle=a,e.fillRect(0,0,W,G),e.fillStyle="rgba(255, 255, 255, 0.4)";for(var s=0;s<40;s++){var l=173*s%W,c=257*s%G,d=Math.max(.8,1-.2*te),u=s%3==0?1.5*d:.8*d,h=.4+.15*(X-1),f=.4+.6*Math.sin(t*h*(.5+s%10/10)+.3*s);e.globalAlpha=f,e.beginPath(),e.arc(l,c,u,0,2*Math.PI),e.fill()}e.globalAlpha=1;var p=.025+.01*(X-1),v=Math.min(.2,.15*te),y=2200-200*X,g=Date.now()/y%40;if(e.strokeStyle="rgba(255, 255, 255, ".concat(p,")"),e.lineWidth=1,p>.01){e.beginPath();var m,x=T($.vertical);try{for(x.s();!(m=x.n()).done;){var b=m.value+g;if(b<W)if(e.moveTo(b,0),v>0)for(var M=0;M<G;M+=5){var S=b+Math.sin(.05*M+1.5*t)*v*8;e.lineTo(S,M)}else e.lineTo(b,G)}}catch(e){x.e(e)}finally{x.f()}e.stroke(),e.beginPath();var A,P=T($.horizontal);try{for(P.s();!(A=P.n()).done;){var w=A.value+g;if(w<G)if(e.moveTo(0,w),v>0)for(var C=0;C<W;C+=5){var k=w+Math.sin(.05*C+1*t)*v*8;e.lineTo(C,k)}else e.lineTo(W,w)}}catch(e){P.e(e)}finally{P.f()}e.stroke()}for(var I=0;I<Q.length;I++){var F=Q[I];e.save(),e.translate(F.x,F.y),e.rotate(F.direction),e.globalAlpha=F.opacity,e.fillStyle=F.color;var B=F.currentSize||F.size;switch(F.shape){case 0:e.beginPath(),e.arc(0,0,B,0,2*Math.PI),e.fill();break;case 1:e.fillRect(-B/2,-B/2,B,B);break;case 2:e.beginPath(),e.moveTo(0,-B),e.lineTo(B,0),e.lineTo(0,B),e.lineTo(-B,0),e.closePath(),e.fill();break;case 3:Ee(e,0,0,5,B,B/2);break;case 4:e.beginPath(),e.moveTo(0,-B),e.lineTo(.866*B,.5*B),e.lineTo(.866*-B,.5*B),e.closePath(),e.fill()}if(te>.3&&Math.random()<.07*te)switch(e.globalAlpha=.6*F.opacity,e.fillStyle=K[Math.floor(3*Math.random())],e.translate(3*(Math.random()-.5)*te,3*(Math.random()-.5)*te),F.shape){case 0:case 2:case 3:case 4:e.beginPath(),e.arc(0,0,B*(.8+.4*Math.random()),0,2*Math.PI),e.fill();break;case 1:var R=B*(.8+.4*Math.random());e.fillRect(-R/2,-R/2,R,R)}var _=Math.min(.4,.2+.07*(X-1));if(X>1.2&&Math.random()>.45){var L=1.4*B,E=F.opacity*_;e.globalAlpha=E,e.beginPath(),e.arc(0,0,L,0,2*Math.PI),e.fill()}e.restore()}var V=.7*X,D=.05+.07*Math.sin(t*V)*(X-1)/2.5;if(X>1.4)try{var O=parseInt(K[2].substr(1,2),16),z=parseInt(K[2].substr(3,2),16),q=parseInt(K[2].substr(5,2),16);e.fillStyle="rgba(".concat(O,", ").concat(z,", ").concat(q,", ").concat(D,")"),e.fillRect(0,0,W,G)}catch(t){e.fillStyle="rgba(255, 255, 255, ".concat(D,")"),e.fillRect(0,0,W,G)}if(X>1.8){var j=Math.min(.5,.25*(X-1.8)),H=e.createRadialGradient(400,325,195,400,325,520);H.addColorStop(0,"rgba(0,0,0,0)"),H.addColorStop(1,"rgba(0,0,0,".concat(j,")")),e.fillStyle=H,e.fillRect(0,0,W,G)}oe>0&&e.restore()}(e);var t=e.createLinearGradient(U,0,980,G);t.addColorStop(0,"#1A2A3A"),t.addColorStop(.5,"#223244"),t.addColorStop(1,"#1A2A3A"),e.fillStyle=t,e.fillRect(U,0,180,G),e.fillStyle="rgba(0, 30, 60, 0.1)";for(var o=0;o<G;o+=20)e.fillRect(U,o,180,10);var n=e.createLinearGradient(U,0,980,60);n.addColorStop(0,"#4A3000"),n.addColorStop(1,"#644200"),e.fillStyle=n,e.fillRect(U,0,180,60),e.strokeStyle="#FFCC33",e.lineWidth=2,e.beginPath(),e.moveTo(U,59),e.lineTo(980,59),e.stroke(),e.lineWidth=1,e.beginPath(),e.moveTo(U,54),e.lineTo(980,54),e.stroke();var r=e.createLinearGradient(U,0,805,0);r.addColorStop(0,"#663300"),r.addColorStop(1,"#442200"),e.fillStyle=r,e.fillRect(U,0,5,G),e.strokeStyle="rgba(255, 204, 51, 0.5)",e.lineWidth=1,e.beginPath(),e.moveTo(U,0),e.lineTo(U,G),e.stroke();for(var i=O.allBodies(be),a=0;a<i.length;a++){var s=i[a];if("launcher_base"===s.label){e.save();var l=e.createRadialGradient(s.position.x-10,s.position.y-10,5,s.position.x,s.position.y,30);l.addColorStop(0,"#FF9933"),l.addColorStop(.4,"#FF6600"),l.addColorStop(1,"#CC5500"),e.beginPath(),e.arc(s.position.x,s.position.y,30,0,2*Math.PI),e.fillStyle=l,e.fill(),e.beginPath(),e.arc(s.position.x-10,s.position.y-10,8,0,2*Math.PI),e.fillStyle="rgba(255, 255, 255, 0.7)",e.fill(),e.beginPath(),e.arc(s.position.x,s.position.y,30,0,2*Math.PI),e.strokeStyle="#000000",e.lineWidth=3,e.stroke(),e.beginPath(),e.arc(s.position.x+2,s.position.y+2,30,0,2*Math.PI),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.lineWidth=4,e.stroke(),e.restore()}if("peg"===s.label){e.save();var c=s.isHit?"#999999":s.originalColor,d=s.isHit,u=Date.now(),h=31*s.position.x+s.position.y+1e3*(s.colorGroup||0),f=s.animationOffset||0,p=Math.floor(39*h%360);e.translate(s.position.x,s.position.y),d||(e.beginPath(),e.arc(0,0,9,0,2*Math.PI),e.fillStyle=c,e.fill());var v=void 0,y=void 0,g=void 0;switch(s.colorGroup){case 0:default:v="rgb(220, 0, 0)",y="rgba(255, 50, 50, 0.8)",g="rgb(150, 0, 0)";break;case 1:v="rgb(0, 0, 220)",y="rgba(50, 50, 255, 0.8)",g="rgb(0, 0, 150)";break;case 2:v="rgb(220, 220, 0)",y="rgba(255, 255, 50, 0.8)",g="rgb(150, 150, 0)";break;case 3:v="rgb(0, 220, 0)",y="rgba(50, 255, 50, 0.8)",g="rgb(0, 150, 0)";break;case 4:v="rgb(220, 0, 220)",y="rgba(255, 50, 255, 0.8)",g="rgb(150, 0, 150)";break;case 5:v="rgb(0, 220, 220)",y="rgba(50, 255, 255, 0.8)",g="rgb(0, 150, 150)";break;case 6:v="rgb(220, 120, 0)",y="rgba(255, 150, 50, 0.8)",g="rgb(150, 80, 0)";break;case 7:v="rgb(120, 0, 220)",y="rgba(150, 50, 255, 0.8)",g="rgb(80, 0, 150)"}var m=1+.2*Math.sin(.001*(u+f)+.1*h);if(!d){var x=e.createRadialGradient(0,0,7,0,0,11*m);x.addColorStop(0,y),x.addColorStop(.7,"rgba(0, 0, 0, 0)"),e.globalCompositeOperation="lighten",e.beginPath(),e.arc(0,0,11*m,0,2*Math.PI),e.fillStyle=x,e.fill(),e.globalCompositeOperation="source-over"}var b=e.createRadialGradient(-3,-3,1,0,0,q);if(d?(b.addColorStop(0,"rgba(180, 180, 180, 0.7)"),b.addColorStop(.4,"rgba(150, 150, 150, 0.7)"),b.addColorStop(.7,"rgba(120, 120, 120, 0.7)"),b.addColorStop(1,"rgba(80, 80, 80, 0.7)")):(b.addColorStop(0,y),b.addColorStop(.5,v),b.addColorStop(1,g)),e.beginPath(),e.arc(0,0,q,0,2*Math.PI),e.fillStyle=b,e.fill(),!d){e.save(),e.globalCompositeOperation="overlay";for(var M=2+Math.floor(3*Math.abs(Math.sin(.7*h))),S=0;S<M;S++){var A=S/M*Math.PI*2+.5*Math.sin(.0015*(u+f)+.2*h),P=(.3+.15*Math.sin(.002*(u+f)+S))*Math.PI,w=q*(.5+.2*Math.sin(.001*(u+f)+S+.1*h));e.beginPath(),e.arc(0,0,w,A,A+P);var C=.3+.1*Math.sin(.002*(u+f)+S);e.strokeStyle=d?"rgba(200, 200, 200, ".concat(C,")"):y,e.lineWidth=2+1*Math.sin(.002*(u+f)+S+.05*h),e.stroke()}e.restore()}if(!d){e.save(),e.globalCompositeOperation="overlay";for(var k=0;k<3;k++){var I=(.05*(u+f)+200*k)%40-10-q,F=.2+.1*Math.sin(.001*(u+f)+.5*k);if(Math.abs(I)<=q){e.beginPath();var B=2*Math.sqrt(100-I*I);e.moveTo(-B/2,I),e.lineTo(B/2,I),e.strokeStyle="rgba(220, 220, 220, ".concat(F,")"),e.lineWidth=1.5,e.stroke()}}e.restore()}if(e.beginPath(),e.arc(0,0,q,0,2*Math.PI),d)e.strokeStyle="#666666";else switch(s.colorGroup){case 0:e.strokeStyle="rgb(255, 0, 0)";break;case 1:e.strokeStyle="rgb(0, 0, 255)";break;case 2:e.strokeStyle="rgb(255, 255, 0)";break;case 3:e.strokeStyle="rgb(0, 255, 0)";break;case 4:e.strokeStyle="rgb(255, 0, 255)";break;case 5:e.strokeStyle="rgb(0, 255, 255)";break;case 6:e.strokeStyle="rgb(255, 165, 0)";break;case 7:e.strokeStyle="rgb(160, 32, 240)";break;default:e.strokeStyle="hsl(".concat(p,", 100%, 50%)")}e.lineWidth=2,e.stroke(),e.restore()}if("ball"===s.label){e.save();try{if(s.rotation||(s.rotation={x:Math.random()*Math.PI*2,y:Math.random()*Math.PI*2,z:s.spinAngle||0,vx:.01+.02*Math.random(),vy:.01+.02*Math.random(),vz:.02+.03*Math.random(),lastVelocity:s.velocity?{x:s.velocity.x,y:s.velocity.y}:{x:0,y:0},wobbleAmplitude:{x:0,y:0,z:0},wobbleFrequency:{x:0,y:0,z:0},wobblePhase:{x:0,y:0,z:0},wobbleDamping:.95,lastCollision:0}),s.velocity)try{var _,L,z=s.velocity.x-((null===(_=s.rotation.lastVelocity)||void 0===_?void 0:_.x)||0),Z=s.velocity.y-((null===(L=s.rotation.lastVelocity)||void 0===L?void 0:L.y)||0),Y=Math.sqrt(z*z+Z*Z),J=Date.now();Y>3&&J-s.rotation.lastCollision>100&&(s.rotation.wobbleAmplitude.x=.08*Math.min(1,Y/10),s.rotation.wobbleAmplitude.y=.07*Math.min(1,Y/10),s.rotation.wobbleAmplitude.z=.05*Math.min(1,Y/10),s.rotation.wobbleFrequency.x=.2+.1*Math.random(),s.rotation.wobbleFrequency.y=.2+.1*Math.random(),s.rotation.wobbleFrequency.z=.2+.1*Math.random(),s.rotation.wobblePhase.x=Math.random()*Math.PI*2,s.rotation.wobblePhase.y=Math.random()*Math.PI*2,s.rotation.wobblePhase.z=Math.random()*Math.PI*2,s.rotation.lastCollision=J);var ee=Math.max(-5,Math.min(5,z)),ne=Math.max(-5,Math.min(5,Z));s.rotation.vx+=.008*ne,s.rotation.vy-=.008*ee;var ue=Math.sqrt(s.velocity.x*s.velocity.x+s.velocity.y*s.velocity.y);s.rotation.vz+=.001*Math.sign(s.velocity.x)*ue;var pe=.15;s.rotation.vx=Math.max(-.15,Math.min(pe,s.rotation.vx)),s.rotation.vy=Math.max(-.15,Math.min(pe,s.rotation.vy)),s.rotation.vz=Math.max(-.15,Math.min(pe,s.rotation.vz)),s.rotation.lastVelocity={x:s.velocity.x,y:s.velocity.y};var ve=Math.sqrt(s.velocity.x*s.velocity.x+s.velocity.y*s.velocity.y)/10,me=.35+Math.min(ve,2),xe=Date.now()/1e3,Me=s.rotation.wobbleAmplitude.x*Math.sin(xe*s.rotation.wobbleFrequency.x+s.rotation.wobblePhase.x),Ae=s.rotation.wobbleAmplitude.y*Math.sin(xe*s.rotation.wobbleFrequency.y+s.rotation.wobblePhase.y),Pe=s.rotation.wobbleAmplitude.z*Math.sin(xe*s.rotation.wobbleFrequency.z+s.rotation.wobblePhase.z);s.rotation.x+=s.rotation.vx*me+Me,s.rotation.y+=s.rotation.vy*me+Ae,s.rotation.z+=s.rotation.vz*me*Math.sign(s.velocity.x)+Pe,s.rotation.wobbleAmplitude.x*=s.rotation.wobbleDamping,s.rotation.wobbleAmplitude.y*=s.rotation.wobbleDamping,s.rotation.wobbleAmplitude.z*=s.rotation.wobbleDamping,s.rotation.wobbleAmplitude.x<.001&&(s.rotation.wobbleAmplitude.x=0),s.rotation.wobbleAmplitude.y<.001&&(s.rotation.wobbleAmplitude.y=0),s.rotation.wobbleAmplitude.z<.001&&(s.rotation.wobbleAmplitude.z=0)}catch(e){s.rotation.x+=.01,s.rotation.y+=.015,s.rotation.z+=.02,console.error("Error in ball rotation physics:",e)}else{var we=Date.now()/1e3,Ce=s.rotation.wobbleAmplitude.x*Math.sin(we*s.rotation.wobbleFrequency.x+s.rotation.wobblePhase.x),Fe=s.rotation.wobbleAmplitude.y*Math.sin(we*s.rotation.wobbleFrequency.y+s.rotation.wobblePhase.y),Te=s.rotation.wobbleAmplitude.z*Math.sin(we*s.rotation.wobbleFrequency.z+s.rotation.wobblePhase.z);s.rotation.x+=.5*s.rotation.vx+Ce,s.rotation.y+=.5*s.rotation.vy+Fe,s.rotation.z+=.5*s.rotation.vz+Te,s.rotation.wobbleAmplitude.x*=.98*s.rotation.wobbleDamping,s.rotation.wobbleAmplitude.y*=.98*s.rotation.wobbleDamping,s.rotation.wobbleAmplitude.z*=.98*s.rotation.wobbleDamping,s.rotation.wobbleAmplitude.x<.001&&(s.rotation.wobbleAmplitude.x=0),s.rotation.wobbleAmplitude.y<.001&&(s.rotation.wobbleAmplitude.y=0),s.rotation.wobbleAmplitude.z<.001&&(s.rotation.wobbleAmplitude.z=0)}s.rotation.x=s.rotation.x%(2*Math.PI),s.rotation.y=s.rotation.y%(2*Math.PI),s.rotation.z=s.rotation.z%(2*Math.PI);var Be=Math.sin(s.rotation.x),Re=Math.cos(s.rotation.x),_e=Math.sin(s.rotation.y),Le=Math.cos(s.rotation.y),Ve=Math.sin(s.rotation.z),Oe=Math.cos(s.rotation.z),ze={x:.7*Le*Oe-.35*_e,y:.7*Be*_e*Oe+.7*Re*Ve-.35*Be*Le},We={x:-.5*Le*Oe+.25*_e,y:-.5*Be*_e*Oe-.5*Re*Ve+.25*Be*Le},Ge={x:1.2*Le*Ve,y:-1.2*Be*_e*Ve+1.2*Re*Oe},qe={x:.5,y:-.5,z:.7},je=Math.sqrt(qe.x*qe.x+qe.y*qe.y+qe.z*qe.z),He={x:qe.x/je,y:qe.y/je,z:qe.z/je},Ne={x:ze.x,y:ze.y,z:Math.sqrt(1-ze.x*ze.x-ze.y*ze.y)},Ue=Ne.x*He.x+Ne.y*He.y+Ne.z*He.z,Qe=Math.max(.3,Ue),Xe=.8*Math.pow(Math.max(0,Ue),8),Ze=e.createRadialGradient(s.position.x+j*ze.x,s.position.y+j*ze.y,.5,s.position.x,s.position.y,12),Ye=Math.min(255,Math.round(220*Qe+35*Xe)),Ke=Math.min(255,Math.round(180*Qe+20*Xe)),$e=Math.min(255,Math.round(120*Qe+10*Xe)),Je=Math.min(255,Math.round(80*Qe));Ze.addColorStop(0,"rgb(".concat(Ye,", ").concat(Ye,", ").concat(Math.min(255,Ye+5),")")),Ze.addColorStop(.15,"rgb(".concat(Math.round(.98*Ye),", ").concat(Math.round(.98*Ye),", ").concat(Math.round(Ye),")")),Ze.addColorStop(.3,"rgb(".concat(Ke,", ").concat(Ke,", ").concat(Math.min(255,Ke+3),")")),Ze.addColorStop(.5,"rgb(".concat($e,", ").concat($e,", ").concat($e,")")),Ze.addColorStop(.7,"rgb(".concat(Math.round(.75*$e),", ").concat(Math.round(.75*$e),", ").concat(Math.round(.8*$e),")")),Ze.addColorStop(.85,"rgb(".concat(Math.round(.6*$e),", ").concat(Math.round(.6*$e),", ").concat(Math.round(.65*$e),")")),Ze.addColorStop(1,"rgb(".concat(Je,", ").concat(Je,", ").concat(Math.round(1.05*Je),")")),e.beginPath(),e.arc(s.position.x,s.position.y,j,0,2*Math.PI),e.fillStyle=Ze,e.fill(),e.save(),e.beginPath(),e.arc(s.position.x,s.position.y,j,0,2*Math.PI),e.clip();var et=e.createRadialGradient(s.position.x+2.5*ze.x,s.position.y+2.5*ze.y,0,s.position.x,s.position.y,12);et.addColorStop(0,"rgba(220, 225, 235, ".concat(.15+.2*Xe,")")),et.addColorStop(.4,"rgba(200, 205, 215, ".concat(.1+.15*Xe,")")),et.addColorStop(.7,"rgba(180, 185, 195, ".concat(.05+.1*Xe,")")),et.addColorStop(1,"rgba(150, 155, 165, 0)"),e.fillStyle=et,e.fill();for(var tt=0;tt<6;tt++){var ot=(tt+1)/7*Math.PI,nt=Math.sin(ot)*j,rt=Math.cos(ot)*j,it=s.position.y+rt*Re-nt*Be*_e;if(Re*(rt/j)-Be*_e*0<=0&&Math.abs(rt)<9.5){var at=Math.max(.1,nt*Le),st=Math.max(.1,nt*(.4*Math.abs(_e)+.6)),lt=tt/5,ct=Math.abs(lt-.5)<.15,dt=ct?.2:.12;e.beginPath(),e.ellipse(s.position.x,it,at,st,0,0,2*Math.PI),e.strokeStyle="rgba(190, 195, 210, ".concat(dt,")"),e.lineWidth=ct?1.2:.8,e.stroke()}}for(var ut=0;ut<8;ut++){var ht=ut*Math.PI/8+s.rotation.z,ft=Math.cos(ht)*_e+Math.sin(ht)*Le;if(ft>-.1){var pt=(ft+.1)/1.1,vt=Math.max(.05,Math.min(.2,.2*pt));e.beginPath();for(var yt=!1,gt=0;gt<=1;gt+=.02){var mt=gt*Math.PI,xt=Math.sin(mt)*Math.cos(ht),bt=Math.cos(mt),Mt=Math.sin(mt)*Math.sin(ht),St=xt*Le+Mt*_e*1.1,At=bt*Re-(xt*_e-Mt*Le)*Be*1.1,Pt=Mt*Le-xt*_e,wt=s.position.x+St*j,Ct=s.position.y+At*j;Pt>=0?yt?e.lineTo(wt,Ct):(yt=!0,e.moveTo(wt,Ct)):yt&&(e.lineTo(wt,Ct),yt=!1)}var kt=.5*pt+.5;e.strokeStyle="rgba(180, 185, 200, ".concat(vt,")"),e.lineWidth=kt,e.stroke()}}e.restore(),e.save(),e.beginPath(),e.arc(s.position.x,s.position.y,j,0,2*Math.PI),e.clip();var It=Math.atan2(Ge.y,Ge.x);e.translate(s.position.x,s.position.y),e.rotate(It);var Ft=.8*Math.abs(Math.sin(s.rotation.x))+.2,Tt=e.createLinearGradient(-10,0,j,0);Tt.addColorStop(0,"rgba(235, 235, 240, 0.7)"),Tt.addColorStop(.2,"rgba(210, 215, 225, 0.6)"),Tt.addColorStop(.4,"rgba(180, 185, 200, 0.5)"),Tt.addColorStop(.6,"rgba(160, 165, 180, 0.5)"),Tt.addColorStop(.8,"rgba(190, 195, 205, 0.6)"),Tt.addColorStop(1,"rgba(220, 225, 235, 0.7)"),e.fillStyle=Tt,e.beginPath();var Bt=Math.max(.1,j),Rt=Math.max(.1,Ft);e.ellipse(0,0,Bt,6*Rt,0,0,2*Math.PI),e.fill(),e.restore();var _t=Math.atan2(ze.y,ze.x),Lt=e.createRadialGradient(s.position.x+j*ze.x,s.position.y+j*ze.y,0,s.position.x+j*ze.x,s.position.y+j*ze.y,Math.max(.1,6));Lt.addColorStop(0,"rgba(255, 255, 255, ".concat(.9+.1*Xe,")")),Lt.addColorStop(.3,"rgba(240, 240, 245, ".concat(.6+.1*Xe,")")),Lt.addColorStop(.6,"rgba(220, 225, 235, ".concat(.3+.1*Xe,")")),Lt.addColorStop(1,"rgba(200, 205, 220, 0)"),e.beginPath();var Et=Math.max(.1,5.5),Vt=Math.max(.1,4);e.ellipse(s.position.x+j*ze.x,s.position.y+j*ze.y,Et,Vt,_t+Math.PI/4,0,2*Math.PI),e.fillStyle=Lt,e.fill();var Dt=Math.atan2(We.y,We.x),Ot=e.createRadialGradient(s.position.x+j*We.x,s.position.y+j*We.y,0,s.position.x+j*We.x,s.position.y+j*We.y,Math.max(.1,4));Ot.addColorStop(0,"rgba(210, 215, 225, 0.5)"),Ot.addColorStop(.5,"rgba(180, 185, 200, 0.25)"),Ot.addColorStop(1,"rgba(150, 155, 170, 0)"),e.beginPath(),e.ellipse(s.position.x+j*We.x,s.position.y+j*We.y,Math.max(.1,4.5),Math.max(.1,3),Dt+Math.PI/4,0,2*Math.PI),e.fillStyle=Ot,e.fill(),e.beginPath(),e.ellipse(s.position.x,s.position.y+8,5,1.5,0,0,2*Math.PI),e.fillStyle="rgba(200, 205, 215, 0.25)",e.fill()}catch(t){console.error("Error in 3D ball rendering:",t),e.beginPath(),e.arc(s.position.x,s.position.y,j,0,2*Math.PI);var zt=e.createRadialGradient(s.position.x-3,s.position.y-3,1,s.position.x,s.position.y,j);zt.addColorStop(0,"#FFFFFF"),zt.addColorStop(.3,"#CCCCCC"),zt.addColorStop(1,"#666666"),e.fillStyle=zt,e.fill(),e.beginPath(),e.arc(s.position.x-3,s.position.y-3,3,0,2*Math.PI),e.fillStyle="rgba(255, 255, 255, 0.5)",e.fill()}e.beginPath(),e.arc(s.position.x,s.position.y,j,0,2*Math.PI),e.strokeStyle="rgba(40, 40, 40, 0.4)",e.lineWidth=1,e.stroke(),e.restore()}}var Wt=Se.context;Wt.save(),Wt.globalAlpha=1,Wt.beginPath(),Wt.moveTo(H,N),Wt.lineTo(H+50*Math.cos(de),N+50*Math.sin(de)),Wt.lineWidth=8,Wt.strokeStyle="#FF0000",Wt.stroke();var Gt=H+50*Math.cos(de),qt=N+50*Math.sin(de),jt=Math.PI/8;Wt.beginPath(),Wt.moveTo(Gt,qt),Wt.lineTo(Gt-12*Math.cos(de-jt),qt-12*Math.sin(de-jt)),Wt.lineTo(Gt-12*Math.cos(de+jt),qt-12*Math.sin(de+jt)),Wt.closePath(),Wt.fillStyle="#FF0000",Wt.fill();var Ht=H+50*Math.cos(de),Nt=N+50*Math.sin(de),Ut=.05*Math.cos(de)*100,Qt=.05*Math.sin(de)*100;try{var Xt=R.create();Xt.world.gravity.y=be.gravity.y;var Zt,Yt=[E.rectangle(400,-30,W,60,{isStatic:!0}),E.rectangle(-30,325,60,G,{isStatic:!0}),E.rectangle(830,325,60,G,{isStatic:!0})],Kt=[],$t=O.allBodies(be).filter((function(e){return"peg"===e.label})),Jt=T($t);try{for(Jt.s();!(Zt=Jt.n()).done;){var eo=Zt.value;if(!eo.isHit){var to=E.circle(eo.position.x,eo.position.y,q,{isStatic:!0,label:"temp_peg"});Kt.push(to)}}}catch(e){Jt.e(e)}finally{Jt.f()}O.add(Xt.world,[].concat(Yt,Kt));var oo=E.circle(Ht,Nt,j,{restitution:.8,friction:.001,frictionAir:5e-4,label:"temp_ball"});V.setVelocity(oo,{x:Ut,y:Qt}),O.add(Xt.world,oo);var no=!1,ro=null,io=null;D.on(Xt,"collisionStart",(function(e){for(var t=e.pairs,o=function(){var e=t[n];if("temp_ball"===e.bodyA.label&&"temp_peg"===e.bodyB.label||"temp_peg"===e.bodyA.label&&"temp_ball"===e.bodyB.label){no=!0;var o="temp_ball"===e.bodyA.label?e.bodyA:e.bodyB,r="temp_peg"===e.bodyA.label?e.bodyA:e.bodyB;ro={x:o.position.x,y:o.position.y};var i=$t.find((function(e){return Math.abs(e.position.x-r.position.x)<1&&Math.abs(e.position.y-r.position.y)<1}));i&&(io=i.originalColor)}},n=0;n<t.length;n++)o()}));var ao=[];ao.push({x:oo.position.x,y:oo.position.y});for(var so=0;so<30&&!no&&(R.update(Xt,16),ao.push({x:oo.position.x,y:oo.position.y}),!(oo.position.y>G||oo.position.x<0||oo.position.x>W));so++);no&&ro&&ao.push(ro),Wt.beginPath(),Wt.setLineDash([8,4]),Wt.moveTo(ao[0].x,ao[0].y);for(var lo=1;lo<ao.length;lo++)Wt.lineTo(ao[lo].x,ao[lo].y);Wt.strokeStyle="rgba(0, 255, 255, 0.7)",Wt.lineWidth=2,Wt.stroke(),Wt.setLineDash([]),no&&ro&&(Wt.beginPath(),Wt.arc(ro.x,ro.y,5,0,2*Math.PI),Wt.fillStyle=io||"rgba(255, 255, 0, 0.7)",Wt.fill(),Wt.shadowColor=io||"rgba(255, 255, 0, 0.7)",Wt.shadowBlur=8,Wt.beginPath(),Wt.arc(ro.x,ro.y,3,0,2*Math.PI),Wt.fillStyle="#FFFFFF",Wt.fill(),Wt.shadowBlur=0),D.off(Xt)}catch(e){console.error("Physics simulation error:",e);for(var co=be.gravity.y,uo=Ht,ho=Nt,fo=Ut,po=Qt,vo=[],yo=0;yo<60&&(uo+=.016*fo,ho+=.016*po,po+=.016*co,vo.push({x:uo,y:ho}),!(ho>G||uo<0||uo>W));yo++);Wt.beginPath(),Wt.setLineDash([5,5]),Wt.moveTo(Ht,Nt);for(var go=0,mo=vo;go<mo.length;go++){var xo=mo[go];Wt.lineTo(xo.x,xo.y)}Wt.strokeStyle="rgba(0, 255, 255, 0.8)",Wt.lineWidth=3,Wt.stroke(),Wt.setLineDash([]);for(var bo=0;bo<vo.length;bo+=4)Wt.beginPath(),Wt.arc(vo[bo].x,vo[bo].y,4,0,2*Math.PI),Wt.fillStyle="#FFFFFF",Wt.fill()}Wt.restore();for(var Mo=0;Mo<i.length;Mo++){var So=i[Mo];if("bucket"===So.label){e.save();var Ao=So.vertices,Po=e.createLinearGradient(So.position.x,So.position.y-10,So.position.x,So.position.y+10);Po.addColorStop(0,"#88CCFF"),Po.addColorStop(.5,"#4488CC"),Po.addColorStop(1,"#2266AA"),e.beginPath(),e.moveTo(Ao[0].x,Ao[0].y);for(var wo=1;wo<Ao.length;wo++)e.lineTo(Ao[wo].x,Ao[wo].y);e.closePath(),e.fillStyle=Po,e.fill(),e.strokeStyle="#FFFFFF",e.lineWidth=2,e.stroke(),e.fillStyle="#FFFFFF",e.font='14px "VT323", monospace',e.textAlign="center",e.fillText("+20 POINTS",So.position.x,So.position.y+5),e.restore()}}Se.context.globalAlpha=1,function(){var e,t=Se.context;t.globalAlpha=1,t.fillStyle="#FFCC33",t.font='24px "VT323", monospace',e="Score: ".concat(le),t.fillStyle="#000000",t.fillRect(15,15,180,40),t.strokeStyle="#FFCC33",t.lineWidth=2,t.strokeRect(15,15,180,40),t.fillStyle="#FFCC33",t.textAlign="center",t.textBaseline="middle",t.fillText(e,105,35),t.textAlign="left",t.textBaseline="alphabetic",t.font='24px "VT323", monospace',t.textAlign="left",t.textBaseline="alphabetic",function(e,o,n,r){t.fillStyle="#000000",t.fillRect(e,15,180,40),t.strokeStyle="#FFCC33",t.lineWidth=2,t.strokeRect(e,15,180,40),t.fillStyle="#FFCC33",t.textAlign="left",t.textBaseline="middle",t.fillText("Ammo:",615,35);for(var i=Math.floor(5.5),a=0;a<r;a++){var s=Math.floor(a/i),l=665+a%i*20+8,c=20*s-(s>0?10:0)+35,d=t.createRadialGradient(l,c,0,l,c,8);d.addColorStop(0,"#FFFFFF"),d.addColorStop(.6,"#3388FF"),d.addColorStop(1,"#0055CC"),t.beginPath(),t.fillStyle=d,t.arc(l,c,8,0,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="rgba(255, 255, 255, 0.7)",t.arc(l-2.4,c-2.4,4,0,2*Math.PI),t.fill()}t.fillStyle="#AAAAAA",t.font='14px "VT323", monospace',t.textAlign="left",t.fillText("Total: ".concat(ae),615,70),t.textAlign="left"}(605,0,0,ce),ge&&(t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(200,265,400,120),t.strokeStyle="#FFCC33",t.lineWidth=4,t.strokeRect(200,265,400,120),t.fillStyle="#FFCC33",t.font='36px "VT323", monospace',t.textAlign="center",t.fillText("GAME OVER!",400,305),t.font='24px "VT323", monospace',t.fillText("Final Score: ".concat(le),400,335),t.fillText("Click to play again",400,365),t.textAlign="left");var o=["#FF0000","#0000FF","#FFFF00","#00FF00","#FF00FF","#00FFFF","#FF8800","#8800FF"],n=["RED","BLUE","YELLOW","GREEN","MAGENTA","CYAN","ORANGE","PURPLE"],r=815,i=De(he);t.fillStyle="#FFCC33",t.font='bold 16px "VT323", monospace',t.textAlign="center",t.fillText("LEVEL ".concat(he," - ").concat(i," COLORS"),890,30),t.strokeStyle="#FFCC33",t.lineWidth=1,t.beginPath(),t.moveTo(815,45),t.lineTo(965,45),t.stroke(),t.fillStyle="#FFFFFF",t.font='bold 16px "VT323", monospace',t.textAlign="center",t.fillText("COLOR PROGRESSION",890,80),t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(815,90,150,55),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.strokeRect(815,90,150,55),t.fillStyle="#FFFFFF",t.font='13px "VT323", monospace',t.textAlign="left",t.fillText("LV 1-2: 4 COLORS",825,105),t.fillText("LV 3-10: 6 COLORS",825,120),t.fillText("LV 11+: 8 COLORS",825,135),t.strokeStyle="#FFCC33",t.lineWidth=1,t.beginPath(),t.moveTo(815,150),t.lineTo(965,150),t.stroke();for(var a=0;a<8;a++)if(!(a>=i&&0===ke[a])){var s=ke[a]>0?Math.min(1,Ie[a]/ke[a]):1,l=ye?ye[a]:.25,c=r+120*l,d=170+50*a,u=a<i?1:.5;t.globalAlpha=u,t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(r,d-15,140,45),t.strokeStyle="rgba(255, 255, 255, 0.2)",t.strokeRect(r,d-15,140,45),t.fillStyle=o[a],t.beginPath(),t.arc(827,d,8,0,2*Math.PI),t.fill(),t.strokeStyle="#FFFFFF",t.lineWidth=1,t.stroke(),t.fillStyle="#FFFFFF",t.font='bold 14px "VT323", monospace',t.textAlign="left",t.fillText(n[a],840,d+4),s>=l&&(t.fillStyle="#FFCC33",t.font='bold 16px "VT323", monospace',t.fillText("✓",945,d+4)),t.fillStyle="#333333",t.fillRect(r,d+10,120,10),t.fillStyle=o[a];var h=120*s;t.fillRect(r,d+10,h,10),t.strokeStyle="#FFFFFF",t.lineWidth=2,t.beginPath(),t.moveTo(c,d+8),t.lineTo(c,d+10+12),t.stroke(),t.globalAlpha=1}if(fe){t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(200,275,400,100),t.strokeStyle="#FFCC33",t.lineWidth=4,t.strokeRect(200,275,400,100),t.fillStyle="#FFCC33",t.font='36px "VT323", monospace',t.textAlign="center",t.fillText("LEVEL COMPLETE!",400,325),t.font='24px "VT323", monospace';var f=500+50*he;t.fillText("Bonus: ".concat(f," points"),400,355),t.textAlign="left"}re&&function(){var e=Se.context;e.imageSmoothingEnabled=!1,e.fillStyle="#000811",e.fillRect(0,0,W,G);for(var t=0;t<G;t+=8)if(Math.random()>.7){var o=3*Math.sin(.05*t),n=.05+.03*Math.random(),r=(t+.01*Date.now())%360;e.fillStyle="hsla(".concat(r,", 70%, 50%, ").concat(n,")"),e.fillRect(o,t,800,2)}for(var i=0;i<4;i++)if(Math.random()>.8){var a=Math.random()*W,s=Math.random()*G,l=30+100*Math.random(),c=3+8*Math.random(),d=.05+.1*Math.random();e.fillStyle="rgba(255, ".concat(Math.floor(255*Math.random()),", ").concat(Math.floor(155*Math.random()),", ").concat(d,")"),e.fillRect(a,s,l,c)}var u=e.createLinearGradient(175,125,625,525);u.addColorStop(0,"#002040"),u.addColorStop(.5,"#003A1C"),u.addColorStop(1,"#332211"),e.fillStyle=u,e.fillRect(175,125,450,400),e.lineWidth=1,e.strokeStyle="#22DDAA",e.setLineDash([4,4]),e.strokeRect(178,128,444,394),e.setLineDash([]),e.lineWidth=3,e.strokeStyle="#66AACC",e.strokeRect(175,125,450,400),e.fillStyle="#FF3388",e.beginPath(),e.moveTo(175,125),e.lineTo(190,125),e.lineTo(175,140),e.fill(),e.fillStyle="#33FF88",e.beginPath(),e.moveTo(625,125),e.lineTo(610,125),e.lineTo(625,140),e.fill(),e.fillStyle="#8833FF",e.beginPath(),e.moveTo(175,525),e.lineTo(190,525),e.lineTo(175,510),e.fill(),e.fillStyle="#FF8833",e.beginPath(),e.moveTo(625,525),e.lineTo(610,525),e.lineTo(625,510),e.fill();var h=e.createLinearGradient(0,125,0,170);h.addColorStop(0,"#663322"),h.addColorStop(.5,"#884422"),h.addColorStop(1,"#552211"),e.fillStyle=h,e.fillRect(175,125,450,45),e.fillStyle="#FFDD33",e.font='bold 36px "VT323", monospace',e.textAlign="center",e.fillText("SHOP",400,155),e.fillStyle="#FF6677",e.fillText("SHOP",401,156),e.font='bold 28px "VT323", monospace',e.fillStyle="rgba(0,0,0,0.4)",e.fillText("Currency: ".concat(ie),401,206);var f=e.createLinearGradient(300,185,500,215);f.addColorStop(0,"#EEEE33"),f.addColorStop(.5,"#33DDAA"),f.addColorStop(1,"#EE33AA"),e.fillStyle=f,e.fillText("Currency: ".concat(ie),400,205);var p=225,v=255,y=e.createLinearGradient(p,v,p,315);y.addColorStop(0,"#331155"),y.addColorStop(.5,"#442266"),y.addColorStop(1,"#221133"),e.fillStyle=y,e.fillRect(p,v,350,60),e.lineWidth=1,e.strokeStyle="#7755AA",e.beginPath(),e.moveTo(p,315),e.lineTo(p,v),e.lineTo(575,v),e.stroke(),e.strokeStyle="#221133",e.beginPath(),e.moveTo(p,315),e.lineTo(575,315),e.lineTo(575,v),e.stroke(),e.fillStyle="rgba(255, 255, 255, 0.07)";for(var g=260;g<275;g+=4)for(var m=230;m<570;m+=4)(m+g)%8==0&&e.fillRect(m,g,2,2);e.fillStyle="#221133",e.font='bold 24px "VT323", monospace',e.fillText("Buy Ball - ".concat(se," currency each"),401,292),e.fillStyle="#DDAAFF",e.fillText("Buy Ball - ".concat(se," currency each"),400,290);for(var x=Date.now(),b=300;b<500;b+=10){var M=3*Math.sin(.03*b+5e-4*x);e.fillStyle=b%20==0?"#DDBB00":"#111111",e.fillRect(b,340+M,10,30)}var S="(Max: 10)";e.strokeStyle="#000000",e.lineWidth=2,e.strokeText("Current Balls: ".concat(ae," ").concat(S),400,355),e.fillStyle="#FFFFFF",e.font='bold 24px "VT323", monospace',e.fillText("Current Balls: ".concat(ae," ").concat(S),400,355);var A=300,P=425,w=e.createLinearGradient(A,P,A,475);w.addColorStop(0,"#114422"),w.addColorStop(.5,"#227722"),w.addColorStop(1,"#003300"),e.fillStyle=w,e.fillRect(A,P,200,50),e.lineWidth=1,e.strokeStyle="#55DD55",e.beginPath(),e.moveTo(A,475),e.lineTo(A,P),e.lineTo(500,P),e.stroke(),e.strokeStyle="#003300",e.beginPath(),e.moveTo(A,475),e.lineTo(500,475),e.lineTo(500,P),e.stroke(),e.fillStyle="#002200",e.font='bold 28px "VT323", monospace',e.fillText("Continue",401,462),e.fillStyle="#AAEE33",e.fillText("Continue",400,460);var C=Date.now()%1500/1500*12;e.strokeStyle="#FFFFFF",e.lineWidth=1,e.setLineDash([4,6]),e.lineDashOffset=C,e.strokeRect(295,420,210,60),e.setLineDash([]),e.imageSmoothingEnabled=!0}()}()})),_.run(Se),requestAnimationFrame((function e(t){Be||(Be=t);var o=t-Be;for(Be=t,Re+=o;Re>=Te;)R.update(xe,Te),Re-=Te;!function(){for(var e=Date.now(),t=[],o=ue.length-1;o>=0;o--){var n=ue[o],r=n.peg;e-n.hitTime>=2e3&&(t.push(r),ue.splice(o,1))}if(t.length>0){var i=O.allBodies(be).filter((function(e){return"ball"===e.label})),a=t.map((function(e){return{x:e.position.x,y:e.position.y}}));O.remove(be,t);var s,l=T(i);try{for(l.s();!(s=l.n()).done;){var c=s.value,d=!1;if(Math.sqrt(c.velocity.x*c.velocity.x+c.velocity.y*c.velocity.y)<.2){var u,h=T(a);try{for(h.s();!(u=h.n()).done;){var f=u.value,p=c.position.x-f.x,v=c.position.y-f.y;if(Math.sqrt(p*p+v*v)<25){d=!0;break}}}catch(e){h.e(e)}finally{h.f()}}d&&(c.isSleeping&&(V.setStatic(c,!1),z.set(c,!1)),c.collisionFilter.group=0)}}catch(e){l.e(e)}finally{l.f()}}}(),function(e){if(Q&&0!==Q.length&&0==(Z=(Z+1)%1)){var t=Date.now()/1e3;oe>0&&(oe=Math.max(0,oe-2e-4*e));for(var o=0;o<Q.length;o++){var n=Q[o];if(Math.random()<.005*X+.01*n.erraticMovement){var r=(Math.random()-.5)*Math.PI*.2*X;n.direction+=r*(1+1.2*n.erraticMovement)}var i=Math.cos(n.direction)*n.speed,a=Math.sin(n.direction)*n.speed;n.erraticMovement>.45&&(i+=Math.sin(1.2*t+o)*n.erraticMovement*.15,a+=Math.cos(1*t+.7*o)*n.erraticMovement*.15),n.x+=i*e*.1,n.y+=a*e*.1,n.direction+=n.spin*e*.1,n.x<-50&&(n.x=850),n.x>850&&(n.x=-50),n.y<-50&&(n.y=700),n.y>700&&(n.y=-50);var s=.15+.07*(X-1);if(n.currentSize=n.size*(1+s*Math.sin(t*n.pulse+n.pulsePhase)),Math.random()<.015*X&&(n.opacity=Math.max(.05,Math.min(.4,n.opacity+.06*(Math.random()-.5)))),Math.random()<n.glitchChance)if(Math.random()<.2)n.x=Math.random()*W,n.y=Math.random()*G;else{var l=Math.floor(3*Math.random());n.color=K[l]}}}}(o);for(var n=O.allBodies(be),r=0;r<n.length;r++){var i=n[r];"ball"===i.label&&i.position.y>750&&L.remove(be,i)}var a=Fe.position;a.x>710?pe=-1:a.x<90&&(pe=1),V.setPosition(Fe,{x:a.x+pe*ve,y:a.y}),Le();var s=n.filter((function(e){return"ball"===e.label}));ce<=0&&0===s.length&&!fe&&!re&&(ae<=0?ge=!0:Le()),requestAnimationFrame(e)})),document.addEventListener("keydown",(function(e){if("l"!==e.key&&"L"!==e.key||(J=!0,ee="",console.log("Enter level number and press Enter")),J)if("Enter"===e.key){var t=parseInt(ee,10);!isNaN(t)&&t>0&&(o=t,fe||o!==he&&(console.log("Skipping to level ".concat(o)),ne={active:!0,startTime:Date.now(),duration:1e3,nextLevel:o},setTimeout((function(){he=o,_e(),ne.active=!1}),1500))),J=!1,ee=""}else/^\d$/.test(e.key)?(ee+=e.key,console.log("Level input: ".concat(ee))):"Escape"===e.key&&(J=!1,ee="",console.log("Level input cancelled"));var o}))})()})();